// @bun
var Yt=Object.create,{defineProperty:bt,getPrototypeOf:Jt,getOwnPropertyNames:$t}=Object,er=Object.prototype.hasOwnProperty,Be=(e,r,s)=>{s=e!=null?Yt(Jt(e)):{};const a=r||!e||!e.__esModule?bt(s,"default",{value:e,enumerable:!0}):s;for(let T of $t(e))if(!er.call(a,T))bt(a,T,{get:()=>e[T],enumerable:!0});return a},ge=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),Pe=ge((e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Type=e.StandardType=e.ExtendedTypeBuilder=e.StandardTypeBuilder=e.TypeBuilder=e.TemplateLiteralDslParser=e.TemplateLiteralGenerator=e.TemplateLiteralFinite=e.TemplateLiteralParser=e.TemplateLiteralParserError=e.TemplateLiteralResolver=e.TemplateLiteralPattern=e.UnionResolver=e.KeyArrayResolver=e.KeyResolver=e.ObjectMap=e.Intrinsic=e.IndexedAccessor=e.TypeClone=e.TypeExtends=e.TypeExtendsResult=e.ExtendsUndefined=e.TypeGuard=e.TypeGuardUnknownTypeError=e.ValueGuard=e.FormatRegistry=e.TypeRegistry=e.PatternStringExact=e.PatternNumberExact=e.PatternBooleanExact=e.PatternString=e.PatternNumber=e.PatternBoolean=e.Kind=e.Hint=e.Optional=e.Readonly=void 0,e.Readonly=Symbol.for("TypeBox.Readonly"),e.Optional=Symbol.for("TypeBox.Optional"),e.Hint=Symbol.for("TypeBox.Hint"),e.Kind=Symbol.for("TypeBox.Kind"),e.PatternBoolean="(true|false)",e.PatternNumber="(0|[1-9][0-9]*)",e.PatternString="(.*)",e.PatternBooleanExact=`^${e.PatternBoolean}$`,e.PatternNumberExact=`^${e.PatternNumber}$`,e.PatternStringExact=`^${e.PatternString}$`;var r;(function(d){const g=new Map;function S(){return new Map(g)}d.Entries=S;function k(){return g.clear()}d.Clear=k;function K(X){return g.delete(X)}d.Delete=K;function R(X){return g.has(X)}d.Has=R;function H(X,_){g.set(X,_)}d.Set=H;function Q(X){return g.get(X)}d.Get=Q})(r||(e.TypeRegistry=r={}));var s;(function(d){const g=new Map;function S(){return new Map(g)}d.Entries=S;function k(){return g.clear()}d.Clear=k;function K(X){return g.delete(X)}d.Delete=K;function R(X){return g.has(X)}d.Has=R;function H(X,_){g.set(X,_)}d.Set=H;function Q(X){return g.get(X)}d.Get=Q})(s||(e.FormatRegistry=s={}));var a;(function(d){function g(_){return typeof _==="object"&&_!==null}d.IsObject=g;function S(_){return Array.isArray(_)}d.IsArray=S;function k(_){return typeof _==="boolean"}d.IsBoolean=k;function K(_){return _===null}d.IsNull=K;function R(_){return _===void 0}d.IsUndefined=R;function H(_){return typeof _==="bigint"}d.IsBigInt=H;function Q(_){return typeof _==="number"}d.IsNumber=Q;function X(_){return typeof _==="string"}d.IsString=X})(a||(e.ValueGuard=a={}));class T extends Error{constructor(d){super("TypeGuard: Unknown type");this.schema=d}}e.TypeGuardUnknownTypeError=T;var n;(function(d){function g(y){try{return new RegExp(y),!0}catch{return!1}}function S(y){if(!a.IsString(y))return!1;for(let be=0;be<y.length;be++){const we=y.charCodeAt(be);if(we>=7&&we<=13||we===27||we===127)return!1}return!0}function k(y){return H(y)||Ce(y)}function K(y){return a.IsUndefined(y)||a.IsBigInt(y)}function R(y){return a.IsUndefined(y)||a.IsNumber(y)}function H(y){return a.IsUndefined(y)||a.IsBoolean(y)}function Q(y){return a.IsUndefined(y)||a.IsString(y)}function X(y){return a.IsUndefined(y)||a.IsString(y)&&S(y)&&g(y)}function _(y){return a.IsUndefined(y)||a.IsString(y)&&S(y)}function Y(y){return a.IsUndefined(y)||Ce(y)}function ee(y){return c(y,"Any")&&Q(y.$id)}d.TAny=ee;function oe(y){return c(y,"Array")&&y.type==="array"&&Q(y.$id)&&Ce(y.items)&&R(y.minItems)&&R(y.maxItems)&&H(y.uniqueItems)&&Y(y.contains)&&R(y.minContains)&&R(y.maxContains)}d.TArray=oe;function M(y){return c(y,"AsyncIterator")&&y.type==="AsyncIterator"&&Q(y.$id)&&Ce(y.items)}d.TAsyncIterator=M;function J(y){return c(y,"BigInt")&&y.type==="bigint"&&Q(y.$id)&&K(y.multipleOf)&&K(y.minimum)&&K(y.maximum)&&K(y.exclusiveMinimum)&&K(y.exclusiveMaximum)}d.TBigInt=J;function re(y){return c(y,"Boolean")&&y.type==="boolean"&&Q(y.$id)}d.TBoolean=re;function te(y){if(!(c(y,"Constructor")&&y.type==="constructor"&&Q(y.$id)&&a.IsArray(y.parameters)&&Ce(y.returns)))return!1;for(let be of y.parameters)if(!Ce(be))return!1;return!0}d.TConstructor=te;function q(y){return c(y,"Date")&&y.type==="Date"&&Q(y.$id)&&R(y.minimumTimestamp)&&R(y.maximumTimestamp)&&R(y.exclusiveMinimumTimestamp)&&R(y.exclusiveMaximumTimestamp)}d.TDate=q;function le(y){if(!(c(y,"Function")&&y.type==="function"&&Q(y.$id)&&a.IsArray(y.parameters)&&Ce(y.returns)))return!1;for(let be of y.parameters)if(!Ce(be))return!1;return!0}d.TFunction=le;function u(y){return c(y,"Integer")&&y.type==="integer"&&Q(y.$id)&&R(y.multipleOf)&&R(y.minimum)&&R(y.maximum)&&R(y.exclusiveMinimum)&&R(y.exclusiveMaximum)}d.TInteger=u;function i(y){if(!(c(y,"Intersect")&&a.IsArray(y.allOf)&&Q(y.type)&&(H(y.unevaluatedProperties)||Y(y.unevaluatedProperties))&&Q(y.$id)))return!1;if(("type"in y)&&y.type!=="object")return!1;for(let be of y.allOf)if(!Ce(be))return!1;return!0}d.TIntersect=i;function t(y){return c(y,"Iterator")&&y.type==="Iterator"&&Q(y.$id)&&Ce(y.items)}d.TIterator=t;function c(y,be){return h(y)&&y[e.Kind]===be}d.TKindOf=c;function h(y){return a.IsObject(y)&&(e.Kind in y)&&a.IsString(y[e.Kind])}d.TKind=h;function f(y){return ce(y)&&a.IsString(y.const)}d.TLiteralString=f;function w(y){return ce(y)&&a.IsNumber(y.const)}d.TLiteralNumber=w;function z(y){return ce(y)&&a.IsBoolean(y.const)}d.TLiteralBoolean=z;function ce(y){return c(y,"Literal")&&Q(y.$id)&&(a.IsBoolean(y.const)||a.IsNumber(y.const)||a.IsString(y.const))}d.TLiteral=ce;function se(y){return c(y,"Never")&&a.IsObject(y.not)&&Object.getOwnPropertyNames(y.not).length===0}d.TNever=se;function he(y){return c(y,"Not")&&Ce(y.not)}d.TNot=he;function pe(y){return c(y,"Null")&&y.type==="null"&&Q(y.$id)}d.TNull=pe;function Re(y){return c(y,"Number")&&y.type==="number"&&Q(y.$id)&&R(y.multipleOf)&&R(y.minimum)&&R(y.maximum)&&R(y.exclusiveMinimum)&&R(y.exclusiveMaximum)}d.TNumber=Re;function Se(y){if(!(c(y,"Object")&&y.type==="object"&&Q(y.$id)&&a.IsObject(y.properties)&&k(y.additionalProperties)&&R(y.minProperties)&&R(y.maxProperties)))return!1;for(let[be,we]of Object.entries(y.properties)){if(!S(be))return!1;if(!Ce(we))return!1}return!0}d.TObject=Se;function V(y){return c(y,"Promise")&&y.type==="Promise"&&Q(y.$id)&&Ce(y.item)}d.TPromise=V;function ie(y){if(!(c(y,"Record")&&y.type==="object"&&Q(y.$id)&&k(y.additionalProperties)&&a.IsObject(y.patternProperties)))return!1;const be=Object.getOwnPropertyNames(y.patternProperties);if(be.length!==1)return!1;if(!g(be[0]))return!1;if(!Ce(y.patternProperties[be[0]]))return!1;return!0}d.TRecord=ie;function m(y){return c(y,"Ref")&&Q(y.$id)&&a.IsString(y.$ref)}d.TRef=m;function v(y){return c(y,"String")&&y.type==="string"&&Q(y.$id)&&R(y.minLength)&&R(y.maxLength)&&X(y.pattern)&&_(y.format)}d.TString=v;function D(y){return c(y,"Symbol")&&y.type==="symbol"&&Q(y.$id)}d.TSymbol=D;function L(y){return c(y,"TemplateLiteral")&&y.type==="string"&&a.IsString(y.pattern)&&y.pattern[0]==="^"&&y.pattern[y.pattern.length-1]==="$"}d.TTemplateLiteral=L;function fe(y){return c(y,"This")&&Q(y.$id)&&a.IsString(y.$ref)}d.TThis=fe;function ne(y){if(!(c(y,"Tuple")&&y.type==="array"&&Q(y.$id)&&a.IsNumber(y.minItems)&&a.IsNumber(y.maxItems)&&y.minItems===y.maxItems))return!1;if(a.IsUndefined(y.items)&&a.IsUndefined(y.additionalItems)&&y.minItems===0)return!0;if(!a.IsArray(y.items))return!1;for(let be of y.items)if(!Ce(be))return!1;return!0}d.TTuple=ne;function $(y){return c(y,"Undefined")&&y.type==="undefined"&&Q(y.$id)}d.TUndefined=$;function ve(y){return Ee(y)&&y.anyOf.every((be)=>f(be)||w(be))}d.TUnionLiteral=ve;function Ee(y){if(!(c(y,"Union")&&a.IsArray(y.anyOf)&&Q(y.$id)))return!1;for(let be of y.anyOf)if(!Ce(be))return!1;return!0}d.TUnion=Ee;function ke(y){return c(y,"Uint8Array")&&y.type==="Uint8Array"&&Q(y.$id)&&R(y.minByteLength)&&R(y.maxByteLength)}d.TUint8Array=ke;function Le(y){return c(y,"Unknown")&&Q(y.$id)}d.TUnknown=Le;function xe(y){return c(y,"Unsafe")}d.TUnsafe=xe;function Ne(y){return c(y,"Void")&&y.type==="void"&&Q(y.$id)}d.TVoid=Ne;function qe(y){return a.IsObject(y)&&y[e.Readonly]==="Readonly"}d.TReadonly=qe;function ft(y){return a.IsObject(y)&&y[e.Optional]==="Optional"}d.TOptional=ft;function Ce(y){return a.IsObject(y)&&(ee(y)||oe(y)||re(y)||J(y)||M(y)||te(y)||q(y)||le(y)||u(y)||i(y)||t(y)||ce(y)||se(y)||he(y)||pe(y)||Re(y)||Se(y)||V(y)||ie(y)||m(y)||v(y)||D(y)||L(y)||fe(y)||ne(y)||$(y)||Ee(y)||ke(y)||Le(y)||xe(y)||Ne(y)||h(y)&&r.Has(y[e.Kind]))}d.TSchema=Ce})(n||(e.TypeGuard=n={}));var E;(function(d){function g(S){if(S[e.Kind]==="Undefined")return!0;if(S[e.Kind]==="Not")return!g(S.not);if(S[e.Kind]==="Intersect")return S.allOf.every((k)=>g(k));if(S[e.Kind]==="Union")return S.anyOf.some((k)=>g(k));return!1}d.Check=g})(E||(e.ExtendsUndefined=E={}));var o;(function(d){d[d.Union=0]="Union",d[d.True=1]="True",d[d.False=2]="False"})(o||(e.TypeExtendsResult=o={}));var C;(function(d){function g(p){return p===o.False?o.False:o.True}function S(p){return n.TNever(p)||n.TIntersect(p)||n.TUnion(p)||n.TUnknown(p)||n.TAny(p)}function k(p,l){if(n.TNever(l))return t(p,l);if(n.TIntersect(l))return q(p,l);if(n.TUnion(l))return lt(p,l);if(n.TUnknown(l))return xt(p,l);if(n.TAny(l))return K(p,l);throw Error("TypeExtends: StructuralRight")}function K(p,l){return o.True}function R(p,l){if(n.TIntersect(l))return q(p,l);if(n.TUnion(l)&&l.anyOf.some((ye)=>n.TAny(ye)||n.TUnknown(ye)))return o.True;if(n.TUnion(l))return o.Union;if(n.TUnknown(l))return o.True;if(n.TAny(l))return o.True;return o.Union}function H(p,l){if(n.TUnknown(p))return o.False;if(n.TAny(p))return o.Union;if(n.TNever(p))return o.True;return o.False}function Q(p,l){if(S(l))return k(p,l);if(n.TObject(l)&&L(l))return o.True;if(!n.TArray(l))return o.False;return g(Te(p.items,l.items))}function X(p,l){if(S(l))return k(p,l);if(!n.TAsyncIterator(l))return o.False;return g(Te(p.items,l.items))}function _(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(n.TRecord(l))return xe(p,l);return n.TBigInt(l)?o.True:o.False}function Y(p,l){if(n.TLiteral(p)&&a.IsBoolean(p.const))return o.True;return n.TBoolean(p)?o.True:o.False}function ee(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(n.TRecord(l))return xe(p,l);return n.TBoolean(l)?o.True:o.False}function oe(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(!n.TConstructor(l))return o.False;if(p.parameters.length>l.parameters.length)return o.False;if(!p.parameters.every((ye,Oe)=>g(Te(l.parameters[Oe],ye))===o.True))return o.False;return g(Te(p.returns,l.returns))}function M(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(n.TRecord(l))return xe(p,l);return n.TDate(l)?o.True:o.False}function J(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(!n.TFunction(l))return o.False;if(p.parameters.length>l.parameters.length)return o.False;if(!p.parameters.every((ye,Oe)=>g(Te(l.parameters[Oe],ye))===o.True))return o.False;return g(Te(p.returns,l.returns))}function re(p,l){if(n.TLiteral(p)&&a.IsNumber(p.const))return o.True;return n.TNumber(p)||n.TInteger(p)?o.True:o.False}function te(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(n.TRecord(l))return xe(p,l);return n.TInteger(l)||n.TNumber(l)?o.True:o.False}function q(p,l){return l.allOf.every((ye)=>Te(p,ye)===o.True)?o.True:o.False}function le(p,l){return p.allOf.some((ye)=>Te(ye,l)===o.True)?o.True:o.False}function u(p,l){if(S(l))return k(p,l);if(!n.TIterator(l))return o.False;return g(Te(p.items,l.items))}function i(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(n.TRecord(l))return xe(p,l);if(n.TString(l))return qe(p,l);if(n.TNumber(l))return z(p,l);if(n.TInteger(l))return re(p,l);if(n.TBoolean(l))return Y(p,l);return n.TLiteral(l)&&l.const===p.const?o.True:o.False}function t(p,l){return o.False}function c(p,l){return o.True}function h(p){let[l,ye]=[p,0];while(!0){if(!n.TNot(l))break;l=l.not,ye+=1}return ye%2===0?l:e.Type.Unknown()}function f(p,l){if(n.TNot(p))return Te(h(p),l);if(n.TNot(l))return Te(p,h(l));throw new Error("TypeExtends: Invalid fallthrough for Not")}function w(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(n.TRecord(l))return xe(p,l);return n.TNull(l)?o.True:o.False}function z(p,l){if(n.TLiteralNumber(p))return o.True;return n.TNumber(p)||n.TInteger(p)?o.True:o.False}function ce(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(n.TRecord(l))return xe(p,l);return n.TInteger(l)||n.TNumber(l)?o.True:o.False}function se(p,l){return Object.getOwnPropertyNames(p.properties).length===l}function he(p){return L(p)}function pe(p){return se(p,0)||se(p,1)&&("description"in p.properties)&&n.TUnion(p.properties.description)&&p.properties.description.anyOf.length===2&&(n.TString(p.properties.description.anyOf[0])&&n.TUndefined(p.properties.description.anyOf[1])||n.TString(p.properties.description.anyOf[1])&&n.TUndefined(p.properties.description.anyOf[0]))}function Re(p){return se(p,0)}function Se(p){return se(p,0)}function V(p){return se(p,0)}function ie(p){return se(p,0)}function m(p){return L(p)}function v(p){const l=e.Type.Number();return se(p,0)||se(p,1)&&("length"in p.properties)&&g(Te(p.properties.length,l))===o.True}function D(p){return se(p,0)}function L(p){const l=e.Type.Number();return se(p,0)||se(p,1)&&("length"in p.properties)&&g(Te(p.properties.length,l))===o.True}function fe(p){const l=e.Type.Function([e.Type.Any()],e.Type.Any());return se(p,0)||se(p,1)&&("then"in p.properties)&&g(Te(p.properties.then,l))===o.True}function ne(p,l){if(Te(p,l)===o.False)return o.False;if(n.TOptional(p)&&!n.TOptional(l))return o.False;return o.True}function $(p,l){if(n.TUnknown(p))return o.False;if(n.TAny(p))return o.Union;if(n.TNever(p))return o.True;if(n.TLiteralString(p)&&he(l))return o.True;if(n.TLiteralNumber(p)&&Re(l))return o.True;if(n.TLiteralBoolean(p)&&Se(l))return o.True;if(n.TSymbol(p)&&pe(l))return o.True;if(n.TBigInt(p)&&V(l))return o.True;if(n.TString(p)&&he(l))return o.True;if(n.TSymbol(p)&&pe(l))return o.True;if(n.TNumber(p)&&Re(l))return o.True;if(n.TInteger(p)&&Re(l))return o.True;if(n.TBoolean(p)&&Se(l))return o.True;if(n.TUint8Array(p)&&m(l))return o.True;if(n.TDate(p)&&ie(l))return o.True;if(n.TConstructor(p)&&D(l))return o.True;if(n.TFunction(p)&&v(l))return o.True;if(n.TRecord(p)&&n.TString(ke(p)))return l[e.Hint]==="Record"?o.True:o.False;if(n.TRecord(p)&&n.TNumber(ke(p)))return se(l,0)?o.True:o.False;return o.False}function ve(p,l){if(S(l))return k(p,l);if(n.TRecord(l))return xe(p,l);if(!n.TObject(l))return o.False;for(let ye of Object.getOwnPropertyNames(l.properties)){if(!(ye in p.properties))return o.False;if(ne(p.properties[ye],l.properties[ye])===o.False)return o.False}return o.True}function Ee(p,l){if(S(l))return k(p,l);if(n.TObject(l)&&fe(l))return o.True;if(!n.TPromise(l))return o.False;return g(Te(p.item,l.item))}function ke(p){if(e.PatternNumberExact in p.patternProperties)return e.Type.Number();if(e.PatternStringExact in p.patternProperties)return e.Type.String();throw Error("TypeExtends: Cannot get record key")}function Le(p){if(e.PatternNumberExact in p.patternProperties)return p.patternProperties[e.PatternNumberExact];if(e.PatternStringExact in p.patternProperties)return p.patternProperties[e.PatternStringExact];throw Error("TypeExtends: Cannot get record value")}function xe(p,l){const ye=ke(l),Oe=Le(l);if(n.TLiteralString(p)&&n.TNumber(ye)&&g(Te(p,Oe))===o.True)return o.True;if(n.TUint8Array(p)&&n.TNumber(ye))return Te(p,Oe);if(n.TString(p)&&n.TNumber(ye))return Te(p,Oe);if(n.TArray(p)&&n.TNumber(ye))return Te(p,Oe);if(n.TObject(p)){for(let Xt of Object.getOwnPropertyNames(p.properties))if(ne(Oe,p.properties[Xt])===o.False)return o.False;return o.True}return o.False}function Ne(p,l){const ye=Le(p);if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(!n.TRecord(l))return o.False;return Te(ye,Le(l))}function qe(p,l){if(n.TLiteral(p)&&a.IsString(p.const))return o.True;return n.TString(p)?o.True:o.False}function ft(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(n.TRecord(l))return xe(p,l);return n.TString(l)?o.True:o.False}function Ce(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(n.TRecord(l))return xe(p,l);return n.TSymbol(l)?o.True:o.False}function y(p,l){if(n.TTemplateLiteral(p))return Te(A.Resolve(p),l);if(n.TTemplateLiteral(l))return Te(p,A.Resolve(l));throw new Error("TypeExtends: Invalid fallthrough for TemplateLiteral")}function be(p,l){return n.TArray(l)&&p.items!==void 0&&p.items.every((ye)=>Te(ye,l.items)===o.True)}function we(p,l){if(n.TNever(p))return o.True;if(n.TUnknown(p))return o.False;if(n.TAny(p))return o.Union;return o.False}function qt(p,l){if(S(l))return k(p,l);if(n.TObject(l)&&L(l))return o.True;if(n.TArray(l)&&be(p,l))return o.True;if(!n.TTuple(l))return o.False;if(a.IsUndefined(p.items)&&!a.IsUndefined(l.items)||!a.IsUndefined(p.items)&&a.IsUndefined(l.items))return o.False;if(a.IsUndefined(p.items)&&!a.IsUndefined(l.items))return o.True;return p.items.every((ye,Oe)=>Te(ye,l.items[Oe])===o.True)?o.True:o.False}function Ut(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(n.TRecord(l))return xe(p,l);return n.TUint8Array(l)?o.True:o.False}function mt(p,l){if(S(l))return k(p,l);if(n.TObject(l))return $(p,l);if(n.TRecord(l))return xe(p,l);if(n.TVoid(l))return zt(p,l);return n.TUndefined(l)?o.True:o.False}function lt(p,l){return l.anyOf.some((ye)=>Te(p,ye)===o.True)?o.True:o.False}function Ht(p,l){return p.anyOf.every((ye)=>Te(ye,l)===o.True)?o.True:o.False}function xt(p,l){return o.True}function Qt(p,l){if(n.TNever(l))return t(p,l);if(n.TIntersect(l))return q(p,l);if(n.TUnion(l))return lt(p,l);if(n.TAny(l))return K(p,l);if(n.TString(l))return qe(p,l);if(n.TNumber(l))return z(p,l);if(n.TInteger(l))return re(p,l);if(n.TBoolean(l))return Y(p,l);if(n.TArray(l))return H(p,l);if(n.TTuple(l))return we(p,l);if(n.TObject(l))return $(p,l);return n.TUnknown(l)?o.True:o.False}function zt(p,l){if(n.TUndefined(p))return o.True;return n.TUndefined(p)?o.True:o.False}function Zt(p,l){if(n.TIntersect(l))return q(p,l);if(n.TUnion(l))return lt(p,l);if(n.TUnknown(l))return xt(p,l);if(n.TAny(l))return K(p,l);if(n.TObject(l))return $(p,l);return n.TVoid(l)?o.True:o.False}function Te(p,l){if(n.TTemplateLiteral(p)||n.TTemplateLiteral(l))return y(p,l);if(n.TNot(p)||n.TNot(l))return f(p,l);if(n.TAny(p))return R(p,l);if(n.TArray(p))return Q(p,l);if(n.TBigInt(p))return _(p,l);if(n.TBoolean(p))return ee(p,l);if(n.TAsyncIterator(p))return X(p,l);if(n.TConstructor(p))return oe(p,l);if(n.TDate(p))return M(p,l);if(n.TFunction(p))return J(p,l);if(n.TInteger(p))return te(p,l);if(n.TIntersect(p))return le(p,l);if(n.TIterator(p))return u(p,l);if(n.TLiteral(p))return i(p,l);if(n.TNever(p))return c(p,l);if(n.TNull(p))return w(p,l);if(n.TNumber(p))return ce(p,l);if(n.TObject(p))return ve(p,l);if(n.TRecord(p))return Ne(p,l);if(n.TString(p))return ft(p,l);if(n.TSymbol(p))return Ce(p,l);if(n.TTuple(p))return qt(p,l);if(n.TPromise(p))return Ee(p,l);if(n.TUint8Array(p))return Ut(p,l);if(n.TUndefined(p))return mt(p,l);if(n.TUnion(p))return Ht(p,l);if(n.TUnknown(p))return Qt(p,l);if(n.TVoid(p))return Zt(p,l);throw Error(`TypeExtends: Unknown left type operand '${p[e.Kind]}'`)}function Wt(p,l){return Te(p,l)}d.Extends=Wt})(C||(e.TypeExtends=C={}));var b;(function(d){function g(R){const H=Object.getOwnPropertyNames(R).reduce((X,_)=>({...X,[_]:k(R[_])}),{}),Q=Object.getOwnPropertySymbols(R).reduce((X,_)=>({...X,[_]:k(R[_])}),{});return{...H,...Q}}function S(R){return R.map((H)=>k(H))}function k(R){if(a.IsArray(R))return S(R);if(a.IsObject(R))return g(R);return R}function K(R,H={}){return{...k(R),...H}}d.Clone=K})(b||(e.TypeClone=b={}));var P;(function(d){function g(M){return M.map((J)=>{const{[e.Optional]:re,...te}=b.Clone(J);return te})}function S(M){return M.every((J)=>n.TOptional(J))}function k(M){return M.some((J)=>n.TOptional(J))}function K(M){return S(M.allOf)?e.Type.Optional(e.Type.Intersect(g(M.allOf))):M}function R(M){return k(M.anyOf)?e.Type.Optional(e.Type.Union(g(M.anyOf))):M}function H(M){if(M[e.Kind]==="Intersect")return K(M);if(M[e.Kind]==="Union")return R(M);return M}function Q(M,J){const re=M.allOf.reduce((te,q)=>{const le=ee(q,J);return le[e.Kind]==="Never"?te:[...te,le]},[]);return H(e.Type.Intersect(re))}function X(M,J){const re=M.anyOf.map((te)=>ee(te,J));return H(e.Type.Union(re))}function _(M,J){const re=M.properties[J];return a.IsUndefined(re)?e.Type.Never():e.Type.Union([re])}function Y(M,J){const re=M.items;if(a.IsUndefined(re))return e.Type.Never();const te=re[J];if(a.IsUndefined(te))return e.Type.Never();return te}function ee(M,J){if(M[e.Kind]==="Intersect")return Q(M,J);if(M[e.Kind]==="Union")return X(M,J);if(M[e.Kind]==="Object")return _(M,J);if(M[e.Kind]==="Tuple")return Y(M,J);return e.Type.Never()}function oe(M,J,re={}){const te=J.map((q)=>ee(M,q.toString()));return H(e.Type.Union(te,re))}d.Resolve=oe})(P||(e.IndexedAccessor=P={}));var G;(function(d){function g(Y){const[ee,oe]=[Y.slice(0,1),Y.slice(1)];return`${ee.toLowerCase()}${oe}`}function S(Y){const[ee,oe]=[Y.slice(0,1),Y.slice(1)];return`${ee.toUpperCase()}${oe}`}function k(Y){return Y.toUpperCase()}function K(Y){return Y.toLowerCase()}function R(Y,ee){const oe=I.ParseExact(Y.pattern);if(!W.Check(oe))return{...Y,pattern:H(Y.pattern,ee)};const M=[...B.Generate(oe)].map((te)=>e.Type.Literal(te)),J=Q(M,ee),re=e.Type.Union(J);return e.Type.TemplateLiteral([re])}function H(Y,ee){return typeof Y==="string"?ee==="Uncapitalize"?g(Y):ee==="Capitalize"?S(Y):ee==="Uppercase"?k(Y):ee==="Lowercase"?K(Y):Y:Y.toString()}function Q(Y,ee){if(Y.length===0)return[];const[oe,...M]=Y;return[_(oe,ee),...Q(M,ee)]}function X(Y,ee){if(n.TTemplateLiteral(Y))return R(Y,ee);if(n.TUnion(Y))return e.Type.Union(Q(Y.anyOf,ee));if(n.TLiteral(Y))return e.Type.Literal(H(Y.const,ee));return Y}function _(Y,ee){return X(Y,ee)}d.Map=_})(G||(e.Intrinsic=G={}));var x;(function(d){function g(H,Q){return e.Type.Intersect(H.allOf.map((X)=>K(X,Q)),{...H})}function S(H,Q){return e.Type.Union(H.anyOf.map((X)=>K(X,Q)),{...H})}function k(H,Q){return Q(H)}function K(H,Q){if(H[e.Kind]==="Intersect")return g(H,Q);if(H[e.Kind]==="Union")return S(H,Q);if(H[e.Kind]==="Object")return k(H,Q);return H}function R(H,Q,X){return{...K(b.Clone(H),Q),...X}}d.Map=R})(x||(e.ObjectMap=x={}));var F;(function(d){function g(_){return _[0]==="^"&&_[_.length-1]==="$"?_.slice(1,_.length-1):_}function S(_,Y){return _.allOf.reduce((ee,oe)=>[...ee,...H(oe,Y)],[])}function k(_,Y){const ee=_.anyOf.map((oe)=>H(oe,Y));return[...ee.reduce((oe,M)=>M.map((J)=>ee.every((re)=>re.includes(J))?oe.add(J):oe)[0],new Set)]}function K(_,Y){return Object.getOwnPropertyNames(_.properties)}function R(_,Y){return Y.includePatterns?Object.getOwnPropertyNames(_.patternProperties):[]}function H(_,Y){if(n.TIntersect(_))return S(_,Y);if(n.TUnion(_))return k(_,Y);if(n.TObject(_))return K(_,Y);if(n.TRecord(_))return R(_,Y);return[]}function Q(_,Y){return[...new Set(H(_,Y))]}d.ResolveKeys=Q;function X(_){return`^(${Q(_,{includePatterns:!0}).map((Y)=>`(${g(Y)})`).join("|")})$`}d.ResolvePattern=X})(F||(e.KeyResolver=F={}));var N;(function(d){function g(S){if(Array.isArray(S))return S;if(n.TUnionLiteral(S))return S.anyOf.map((k)=>k.const.toString());if(n.TLiteral(S))return[S.const];if(n.TTemplateLiteral(S)){const k=I.ParseExact(S.pattern);if(!W.Check(k))throw Error("KeyArrayResolver: Cannot resolve keys from infinite template expression");return[...B.Generate(k)]}return[]}d.Resolve=g})(N||(e.KeyArrayResolver=N={}));var O;(function(d){function*g(k){for(let K of k.anyOf)if(K[e.Kind]==="Union")yield*g(K);else yield K}function S(k){return e.Type.Union([...g(k)],{...k})}d.Resolve=S})(O||(e.UnionResolver=O={}));var U;(function(d){function g(K){return K.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function S(K,R){if(n.TTemplateLiteral(K))return K.pattern.slice(1,K.pattern.length-1);else if(n.TUnion(K))return`(${K.anyOf.map((H)=>S(H,R)).join("|")})`;else if(n.TNumber(K))return`${R}${e.PatternNumber}`;else if(n.TInteger(K))return`${R}${e.PatternNumber}`;else if(n.TBigInt(K))return`${R}${e.PatternNumber}`;else if(n.TString(K))return`${R}${e.PatternString}`;else if(n.TLiteral(K))return`${R}${g(K.const.toString())}`;else if(n.TBoolean(K))return`${R}${e.PatternBoolean}`;else if(n.TNever(K))throw Error("TemplateLiteralPattern: TemplateLiteral cannot operate on types of TNever");else throw Error(`TemplateLiteralPattern: Unexpected Kind '${K[e.Kind]}'`)}function k(K){return`^${K.map((R)=>S(R,"")).join("")}\$`}d.Create=k})(U||(e.TemplateLiteralPattern=U={}));var A;(function(d){function g(S){const k=I.ParseExact(S.pattern);if(!W.Check(k))return e.Type.String();const K=[...B.Generate(k)].map((R)=>e.Type.Literal(R));return e.Type.Union(K)}d.Resolve=g})(A||(e.TemplateLiteralResolver=A={}));class j extends Error{constructor(d){super(d)}}e.TemplateLiteralParserError=j;var I;(function(d){function g(M,J,re){return M[J]===re&&M.charCodeAt(J-1)!==92}function S(M,J){return g(M,J,"(")}function k(M,J){return g(M,J,")")}function K(M,J){return g(M,J,"|")}function R(M){if(!(S(M,0)&&k(M,M.length-1)))return!1;let J=0;for(let re=0;re<M.length;re++){if(S(M,re))J+=1;if(k(M,re))J-=1;if(J===0&&re!==M.length-1)return!1}return!0}function H(M){return M.slice(1,M.length-1)}function Q(M){let J=0;for(let re=0;re<M.length;re++){if(S(M,re))J+=1;if(k(M,re))J-=1;if(K(M,re)&&J===0)return!0}return!1}function X(M){for(let J=0;J<M.length;J++)if(S(M,J))return!0;return!1}function _(M){let[J,re]=[0,0];const te=[];for(let le=0;le<M.length;le++){if(S(M,le))J+=1;if(k(M,le))J-=1;if(K(M,le)&&J===0){const u=M.slice(re,le);if(u.length>0)te.push(ee(u));re=le+1}}const q=M.slice(re);if(q.length>0)te.push(ee(q));if(te.length===0)return{type:"const",const:""};if(te.length===1)return te[0];return{type:"or",expr:te}}function Y(M){function J(q,le){if(!S(q,le))throw new j("TemplateLiteralParser: Index must point to open parens");let u=0;for(let i=le;i<q.length;i++){if(S(q,i))u+=1;if(k(q,i))u-=1;if(u===0)return[le,i]}throw new j("TemplateLiteralParser: Unclosed group parens in expression")}function re(q,le){for(let u=le;u<q.length;u++)if(S(q,u))return[le,u];return[le,q.length]}const te=[];for(let q=0;q<M.length;q++)if(S(M,q)){const[le,u]=J(M,q),i=M.slice(le,u+1);te.push(ee(i)),q=u}else{const[le,u]=re(M,q),i=M.slice(le,u);if(i.length>0)te.push(ee(i));q=u-1}if(te.length===0)return{type:"const",const:""};if(te.length===1)return te[0];return{type:"and",expr:te}}function ee(M){if(R(M))return ee(H(M));if(Q(M))return _(M);if(X(M))return Y(M);return{type:"const",const:M}}d.Parse=ee;function oe(M){return ee(M.slice(1,M.length-1))}d.ParseExact=oe})(I||(e.TemplateLiteralParser=I={}));var W;(function(d){function g(R){return R.type==="or"&&R.expr.length===2&&R.expr[0].type==="const"&&R.expr[0].const==="0"&&R.expr[1].type==="const"&&R.expr[1].const==="[1-9][0-9]*"}function S(R){return R.type==="or"&&R.expr.length===2&&R.expr[0].type==="const"&&R.expr[0].const==="true"&&R.expr[1].type==="const"&&R.expr[1].const==="false"}function k(R){return R.type==="const"&&R.const===".*"}function K(R){if(S(R))return!0;if(g(R)||k(R))return!1;if(R.type==="and")return R.expr.every((H)=>K(H));if(R.type==="or")return R.expr.every((H)=>K(H));if(R.type==="const")return!0;throw Error("TemplateLiteralFinite: Unknown expression type")}d.Check=K})(W||(e.TemplateLiteralFinite=W={}));var B;(function(d){function*g(H){if(H.length===1)return yield*H[0];for(let Q of H[0])for(let X of g(H.slice(1)))yield`${Q}${X}`}function*S(H){return yield*g(H.expr.map((Q)=>[...R(Q)]))}function*k(H){for(let Q of H.expr)yield*R(Q)}function*K(H){return yield H.const}function*R(H){if(H.type==="and")return yield*S(H);if(H.type==="or")return yield*k(H);if(H.type==="const")return yield*K(H);throw Error("TemplateLiteralGenerator: Unknown expression")}d.Generate=R})(B||(e.TemplateLiteralGenerator=B={}));var ue;(function(d){function*g(R){const H=R.trim().replace(/"|'/g,"");if(H==="boolean")return yield e.Type.Boolean();if(H==="number")return yield e.Type.Number();if(H==="bigint")return yield e.Type.BigInt();if(H==="string")return yield e.Type.String();const Q=H.split("|").map((X)=>e.Type.Literal(X.trim()));return yield Q.length===0?e.Type.Never():Q.length===1?Q[0]:e.Type.Union(Q)}function*S(R){if(R[1]!=="{"){const H=e.Type.Literal("$"),Q=k(R.slice(1));return yield*[H,...Q]}for(let H=2;H<R.length;H++)if(R[H]==="}"){const Q=g(R.slice(2,H)),X=k(R.slice(H+1));return yield*[...Q,...X]}yield e.Type.Literal(R)}function*k(R){for(let H=0;H<R.length;H++)if(R[H]==="$"){const Q=e.Type.Literal(R.slice(0,H)),X=S(R.slice(H));return yield*[Q,...X]}yield e.Type.Literal(R)}function K(R){return[...k(R)]}d.Parse=K})(ue||(e.TemplateLiteralDslParser=ue={}));var Ve=0;class ae{Create(d){return d}Discard(d,g){const{[g]:S,...k}=d;return k}Strict(d){return JSON.parse(JSON.stringify(d))}}e.TypeBuilder=ae;class Z extends ae{ReadonlyOptional(d){return this.Readonly(this.Optional(d))}Readonly(d){return{...b.Clone(d),[e.Readonly]:"Readonly"}}Optional(d){return{...b.Clone(d),[e.Optional]:"Optional"}}Any(d={}){return this.Create({...d,[e.Kind]:"Any"})}Array(d,g={}){return this.Create({...g,[e.Kind]:"Array",type:"array",items:b.Clone(d)})}Boolean(d={}){return this.Create({...d,[e.Kind]:"Boolean",type:"boolean"})}Capitalize(d,g={}){return{...G.Map(b.Clone(d),"Capitalize"),...g}}Composite(d,g){const S=e.Type.Intersect(d,{}),k=F.ResolveKeys(S,{includePatterns:!1}).reduce((K,R)=>({...K,[R]:e.Type.Index(S,[R])}),{});return e.Type.Object(k,g)}Enum(d,g={}){const S=Object.getOwnPropertyNames(d).filter((k)=>isNaN(k)).map((k)=>d[k]).map((k)=>a.IsString(k)?{[e.Kind]:"Literal",type:"string",const:k}:{[e.Kind]:"Literal",type:"number",const:k});return this.Create({...g,[e.Kind]:"Union",anyOf:S})}Extends(d,g,S,k,K={}){switch(C.Extends(d,g)){case o.Union:return this.Union([b.Clone(S,K),b.Clone(k,K)]);case o.True:return b.Clone(S,K);case o.False:return b.Clone(k,K)}}Exclude(d,g,S={}){if(n.TTemplateLiteral(d))return this.Exclude(A.Resolve(d),g,S);if(n.TTemplateLiteral(g))return this.Exclude(d,A.Resolve(g),S);if(n.TUnion(d)){const k=d.anyOf.filter((K)=>C.Extends(K,g)===o.False);return k.length===1?b.Clone(k[0],S):this.Union(k,S)}else return C.Extends(d,g)!==o.False?this.Never(S):b.Clone(d,S)}Extract(d,g,S={}){if(n.TTemplateLiteral(d))return this.Extract(A.Resolve(d),g,S);if(n.TTemplateLiteral(g))return this.Extract(d,A.Resolve(g),S);if(n.TUnion(d)){const k=d.anyOf.filter((K)=>C.Extends(K,g)!==o.False);return k.length===1?b.Clone(k[0],S):this.Union(k,S)}else return C.Extends(d,g)!==o.False?b.Clone(d,S):this.Never(S)}Index(d,g,S={}){if(n.TArray(d)&&n.TNumber(g))return b.Clone(d.items,S);else if(n.TTuple(d)&&n.TNumber(g)){const k=(a.IsUndefined(d.items)?[]:d.items).map((K)=>b.Clone(K));return this.Union(k,S)}else{const k=N.Resolve(g),K=b.Clone(d);return P.Resolve(K,k,S)}}Integer(d={}){return this.Create({...d,[e.Kind]:"Integer",type:"integer"})}Intersect(d,g={}){if(d.length===0)return e.Type.Never();if(d.length===1)return b.Clone(d[0],g);const S=d.every((R)=>n.TObject(R)),k=d.map((R)=>b.Clone(R)),K=n.TSchema(g.unevaluatedProperties)?{unevaluatedProperties:b.Clone(g.unevaluatedProperties)}:{};if(g.unevaluatedProperties===!1||n.TSchema(g.unevaluatedProperties)||S)return this.Create({...g,...K,[e.Kind]:"Intersect",type:"object",allOf:k});else return this.Create({...g,...K,[e.Kind]:"Intersect",allOf:k})}KeyOf(d,g={}){if(n.TRecord(d)){const S=Object.getOwnPropertyNames(d.patternProperties)[0];if(S===e.PatternNumberExact)return this.Number(g);if(S===e.PatternStringExact)return this.String(g);throw Error("StandardTypeBuilder: Unable to resolve key type from Record key pattern")}else if(n.TTuple(d)){const S=(a.IsUndefined(d.items)?[]:d.items).map((k,K)=>e.Type.Literal(K));return this.Union(S,g)}else if(n.TArray(d))return this.Number(g);else{const S=F.ResolveKeys(d,{includePatterns:!1});if(S.length===0)return this.Never(g);const k=S.map((K)=>this.Literal(K));return this.Union(k,g)}}Literal(d,g={}){return this.Create({...g,[e.Kind]:"Literal",const:d,type:typeof d})}Lowercase(d,g={}){return{...G.Map(b.Clone(d),"Lowercase"),...g}}Never(d={}){return this.Create({...d,[e.Kind]:"Never",not:{}})}Not(d,g){return this.Create({...g,[e.Kind]:"Not",not:b.Clone(d)})}Null(d={}){return this.Create({...d,[e.Kind]:"Null",type:"null"})}Number(d={}){return this.Create({...d,[e.Kind]:"Number",type:"number"})}Object(d,g={}){const S=Object.getOwnPropertyNames(d),k=S.filter((Q)=>n.TOptional(d[Q])),K=S.filter((Q)=>!k.includes(Q)),R=n.TSchema(g.additionalProperties)?{additionalProperties:b.Clone(g.additionalProperties)}:{},H=S.reduce((Q,X)=>({...Q,[X]:b.Clone(d[X])}),{});if(K.length>0)return this.Create({...g,...R,[e.Kind]:"Object",type:"object",properties:H,required:K});else return this.Create({...g,...R,[e.Kind]:"Object",type:"object",properties:H})}Omit(d,g,S={}){const k=N.Resolve(g);return x.Map(b.Clone(d),(K)=>{if(a.IsArray(K.required)){if(K.required=K.required.filter((R)=>!k.includes(R)),K.required.length===0)delete K.required}for(let R of Object.getOwnPropertyNames(K.properties))if(k.includes(R))delete K.properties[R];return this.Create(K)},S)}Partial(d,g={}){return x.Map(d,(S)=>{const k=Object.getOwnPropertyNames(S.properties).reduce((K,R)=>{return{...K,[R]:this.Optional(S.properties[R])}},{});return this.Object(k,this.Discard(S,"required"))},g)}Pick(d,g,S={}){const k=N.Resolve(g);return x.Map(b.Clone(d),(K)=>{if(a.IsArray(K.required)){if(K.required=K.required.filter((R)=>k.includes(R)),K.required.length===0)delete K.required}for(let R of Object.getOwnPropertyNames(K.properties))if(!k.includes(R))delete K.properties[R];return this.Create(K)},S)}Record(d,g,S={}){if(n.TTemplateLiteral(d)){const k=I.ParseExact(d.pattern);return W.Check(k)?this.Object([...B.Generate(k)].reduce((K,R)=>({...K,[R]:b.Clone(g)}),{}),S):this.Create({...S,[e.Kind]:"Record",type:"object",patternProperties:{[d.pattern]:b.Clone(g)}})}else if(n.TUnion(d)){const k=O.Resolve(d);if(n.TUnionLiteral(k)){const K=k.anyOf.reduce((R,H)=>({...R,[H.const]:b.Clone(g)}),{});return this.Object(K,{...S,[e.Hint]:"Record"})}else throw Error("StandardTypeBuilder: Record key of type union contains non-literal types")}else if(n.TLiteral(d))if(a.IsString(d.const)||a.IsNumber(d.const))return this.Object({[d.const]:b.Clone(g)},S);else throw Error("StandardTypeBuilder: Record key of type literal is not of type string or number");else if(n.TInteger(d)||n.TNumber(d))return this.Create({...S,[e.Kind]:"Record",type:"object",patternProperties:{[e.PatternNumberExact]:b.Clone(g)}});else if(n.TString(d)){const k=a.IsUndefined(d.pattern)?e.PatternStringExact:d.pattern;return this.Create({...S,[e.Kind]:"Record",type:"object",patternProperties:{[k]:b.Clone(g)}})}else throw Error("StandardTypeBuilder: Record key is an invalid type")}Recursive(d,g={}){if(a.IsUndefined(g.$id))g.$id=`T${Ve++}`;const S=d({[e.Kind]:"This",$ref:`${g.$id}`});return S.$id=g.$id,this.Create({...g,[e.Hint]:"Recursive",...S})}Ref(d,g={}){if(a.IsString(d))return this.Create({...g,[e.Kind]:"Ref",$ref:d});if(a.IsUndefined(d.$id))throw Error("StandardTypeBuilder.Ref: Target type must specify an $id");return this.Create({...g,[e.Kind]:"Ref",$ref:d.$id})}Required(d,g={}){return x.Map(d,(S)=>{const k=Object.getOwnPropertyNames(S.properties).reduce((K,R)=>{return{...K,[R]:this.Discard(S.properties[R],e.Optional)}},{});return this.Object(k,S)},g)}Rest(d){if(n.TTuple(d)){if(a.IsUndefined(d.items))return[];return d.items.map((g)=>b.Clone(g))}else return[b.Clone(d)]}String(d={}){return this.Create({...d,[e.Kind]:"String",type:"string"})}TemplateLiteral(d,g={}){const S=a.IsString(d)?U.Create(ue.Parse(d)):U.Create(d);return this.Create({...g,[e.Kind]:"TemplateLiteral",type:"string",pattern:S})}Tuple(d,g={}){const[S,k,K]=[!1,d.length,d.length],R=d.map((Q)=>b.Clone(Q)),H=d.length>0?{...g,[e.Kind]:"Tuple",type:"array",items:R,additionalItems:S,minItems:k,maxItems:K}:{...g,[e.Kind]:"Tuple",type:"array",minItems:k,maxItems:K};return this.Create(H)}Uncapitalize(d,g={}){return{...G.Map(b.Clone(d),"Uncapitalize"),...g}}Union(d,g={}){if(n.TTemplateLiteral(d))return A.Resolve(d);else{const S=d;if(S.length===0)return this.Never(g);if(S.length===1)return this.Create(b.Clone(S[0],g));const k=S.map((K)=>b.Clone(K));return this.Create({...g,[e.Kind]:"Union",anyOf:k})}}Unknown(d={}){return this.Create({...d,[e.Kind]:"Unknown"})}Unsafe(d={}){return this.Create({...d,[e.Kind]:d[e.Kind]||"Unsafe"})}Uppercase(d,g={}){return{...G.Map(b.Clone(d),"Uppercase"),...g}}}e.StandardTypeBuilder=Z;class de extends Z{AsyncIterator(d,g={}){return this.Create({...g,[e.Kind]:"AsyncIterator",type:"AsyncIterator",items:b.Clone(d)})}Awaited(d,g={}){const S=(k)=>{if(k.length===0)return k;const[K,...R]=k;return[this.Awaited(K),...S(R)]};return n.TIntersect(d)?e.Type.Intersect(S(d.allOf)):n.TUnion(d)?e.Type.Union(S(d.anyOf)):n.TPromise(d)?this.Awaited(d.item):b.Clone(d,g)}BigInt(d={}){return this.Create({...d,[e.Kind]:"BigInt",type:"bigint"})}ConstructorParameters(d,g={}){return this.Tuple([...d.parameters],{...g})}Constructor(d,g,S){const k=b.Clone(g),K=d.map((R)=>b.Clone(R));return this.Create({...S,[e.Kind]:"Constructor",type:"constructor",parameters:K,returns:k})}Date(d={}){return this.Create({...d,[e.Kind]:"Date",type:"Date"})}Function(d,g,S){const k=b.Clone(g,{}),K=d.map((R)=>b.Clone(R));return this.Create({...S,[e.Kind]:"Function",type:"function",parameters:K,returns:k})}InstanceType(d,g={}){return b.Clone(d.returns,g)}Iterator(d,g={}){return this.Create({...g,[e.Kind]:"Iterator",type:"Iterator",items:b.Clone(d)})}Parameters(d,g={}){return this.Tuple(d.parameters,{...g})}Promise(d,g={}){return this.Create({...g,[e.Kind]:"Promise",type:"Promise",item:b.Clone(d)})}RegExp(d,g={}){const S=a.IsString(d)?d:d.source;return this.Create({...g,[e.Kind]:"String",type:"string",pattern:S})}RegEx(d,g={}){return this.RegExp(d,g)}ReturnType(d,g={}){return b.Clone(d.returns,g)}Symbol(d){return this.Create({...d,[e.Kind]:"Symbol",type:"symbol"})}Undefined(d={}){return this.Create({...d,[e.Kind]:"Undefined",type:"undefined"})}Uint8Array(d={}){return this.Create({...d,[e.Kind]:"Uint8Array",type:"Uint8Array"})}Void(d={}){return this.Create({...d,[e.Kind]:"Void",type:"void"})}}e.ExtendedTypeBuilder=de,e.StandardType=new Z,e.Type=new de}),tr=ge((e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TypeSystem=e.TypeSystemDuplicateFormat=e.TypeSystemDuplicateTypeKind=void 0;var r=Pe();class s extends Error{constructor(n){super(`Duplicate type kind '${n}' detected`)}}e.TypeSystemDuplicateTypeKind=s;class a extends Error{constructor(n){super(`Duplicate string format '${n}' detected`)}}e.TypeSystemDuplicateFormat=a;var T;(function(n){n.ExactOptionalPropertyTypes=!1,n.AllowArrayObjects=!1,n.AllowNaN=!1,n.AllowVoidNull=!1;function E(C,b){if(r.TypeRegistry.Has(C))throw new s(C);return r.TypeRegistry.Set(C,b),(P={})=>r.Type.Unsafe({...P,[r.Kind]:C})}n.Type=E;function o(C,b){if(r.FormatRegistry.Has(C))throw new a(C);return r.FormatRegistry.Set(C,b),C}n.Format=o})(T||(e.TypeSystem=T={}))}),it=ge((e)=>{var r=e&&e.__createBinding||(Object.create?function(a,T,n,E){if(E===void 0)E=n;var o=Object.getOwnPropertyDescriptor(T,n);if(!o||("get"in o?!T.__esModule:o.writable||o.configurable))o={enumerable:!0,get:function(){return T[n]}};Object.defineProperty(a,E,o)}:function(a,T,n,E){if(E===void 0)E=n;a[E]=T[n]}),s=e&&e.__exportStar||function(a,T){for(var n in a)if(n!=="default"&&!Object.prototype.hasOwnProperty.call(T,n))r(T,a,n)};Object.defineProperty(e,"__esModule",{value:!0}),s(tr(),e)}),Ge=ge((e)=>{var r=function(B){return b(B)&&(Symbol.asyncIterator in B)},s=function(B){return b(B)&&(Symbol.iterator in B)},a=function(B){return ArrayBuffer.isView(B)},T=function(B){return B instanceof Promise},n=function(B){return B instanceof Uint8Array},E=function(B){return B instanceof Date},o=function(B,ue){return ue in B},C=function(B){return b(B)&&j(B.constructor)&&B.constructor.name==="Object"},b=function(B){return B!==null&&typeof B==="object"},P=function(B){return Array.isArray(B)&&!ArrayBuffer.isView(B)},G=function(B){return B===void 0},x=function(B){return B===null},F=function(B){return typeof B==="boolean"},N=function(B){return typeof B==="number"},O=function(B){return N(B)&&Number.isInteger(B)},U=function(B){return typeof B==="bigint"},A=function(B){return typeof B==="string"},j=function(B){return typeof B==="function"},I=function(B){return typeof B==="symbol"},W=function(B){return U(B)||F(B)||x(B)||N(B)||A(B)||I(B)||G(B)};Object.defineProperty(e,"__esModule",{value:!0}),e.IsValueType=e.IsSymbol=e.IsFunction=e.IsString=e.IsBigInt=e.IsInteger=e.IsNumber=e.IsBoolean=e.IsNull=e.IsUndefined=e.IsArray=e.IsObject=e.IsPlainObject=e.HasPropertyKey=e.IsDate=e.IsUint8Array=e.IsPromise=e.IsTypedArray=e.IsIterator=e.IsAsyncIterator=void 0,e.IsAsyncIterator=r,e.IsIterator=s,e.IsTypedArray=a,e.IsPromise=T,e.IsUint8Array=n,e.IsDate=E,e.HasPropertyKey=o,e.IsPlainObject=C,e.IsObject=b,e.IsArray=P,e.IsUndefined=G,e.IsNull=x,e.IsBoolean=F,e.IsNumber=N,e.IsInteger=O,e.IsBigInt=U,e.IsString=A,e.IsFunction=j,e.IsSymbol=I,e.IsValueType=W}),st=ge((e)=>{var r=function(Z){F(A.Array);for(let de of Z)x(de)},s=function(Z){F(A.Boolean),F(Z?1:0)},a=function(Z){F(A.BigInt),Ve.setBigInt64(0,Z);for(let de of ae)F(de)},T=function(Z){F(A.Date),x(Z.getTime())},n=function(Z){F(A.Null)},E=function(Z){F(A.Number),Ve.setFloat64(0,Z);for(let de of ae)F(de)},o=function(Z){F(A.Object);for(let de of globalThis.Object.keys(Z).sort())x(de),x(Z[de])},C=function(Z){F(A.String);for(let de=0;de<Z.length;de++)F(Z.charCodeAt(de))},b=function(Z){F(A.Symbol),x(Z.description)},P=function(Z){F(A.Uint8Array);for(let de=0;de<Z.length;de++)F(Z[de])},G=function(Z){return F(A.Undefined)},x=function(Z){if(O.IsArray(Z))return r(Z);if(O.IsBoolean(Z))return s(Z);if(O.IsBigInt(Z))return a(Z);if(O.IsDate(Z))return T(Z);if(O.IsNull(Z))return n(Z);if(O.IsNumber(Z))return E(Z);if(O.IsPlainObject(Z))return o(Z);if(O.IsString(Z))return C(Z);if(O.IsSymbol(Z))return b(Z);if(O.IsUint8Array(Z))return P(Z);if(O.IsUndefined(Z))return G(Z);throw new U(Z)},F=function(Z){j=j^B[Z],j=j*I%W},N=function(Z){return j=BigInt("14695981039346656037"),x(Z),j};Object.defineProperty(e,"__esModule",{value:!0}),e.Hash=e.ByteMarker=e.ValueHashError=void 0;var O=Ge();class U extends Error{constructor(Z){super("Hash: Unable to hash value");this.value=Z}}e.ValueHashError=U;var A;(function(Z){Z[Z.Undefined=0]="Undefined",Z[Z.Null=1]="Null",Z[Z.Boolean=2]="Boolean",Z[Z.Number=3]="Number",Z[Z.String=4]="String",Z[Z.Object=5]="Object",Z[Z.Array=6]="Array",Z[Z.Date=7]="Date",Z[Z.Uint8Array=8]="Uint8Array",Z[Z.Symbol=9]="Symbol",Z[Z.BigInt=10]="BigInt"})(A||(e.ByteMarker=A={}));var j=BigInt("14695981039346656037"),[I,W]=[BigInt("1099511628211"),BigInt("2")**BigInt("64")],B=Array.from({length:256}).map((Z,de)=>BigInt(de)),ue=new Float64Array(1),Ve=new DataView(ue.buffer),ae=new Uint8Array(ue.buffer);e.Hash=N}),rr=ge((e)=>{var r=function(t){return t!==void 0},s=function(t,c){return M.TypeSystem.ExactOptionalPropertyTypes?c in t:t[c]!==void 0},a=function(t){const c=te.IsObject(t);return M.TypeSystem.AllowArrayObjects?c:c&&!te.IsArray(t)},T=function(t){return a(t)&&!(t instanceof Date)&&!(t instanceof Uint8Array)},n=function(t){const c=te.IsNumber(t);return M.TypeSystem.AllowNaN?c:c&&Number.isFinite(t)},E=function(t){const c=te.IsUndefined(t);return M.TypeSystem.AllowVoidNull?c||t===null:c};function*o(t,c,h,f){}function*C(t,c,h,f){if(!te.IsArray(f))return yield{type:q.Array,schema:t,path:h,value:f,message:"Expected array"};if(r(t.minItems)&&!(f.length>=t.minItems))yield{type:q.ArrayMinItems,schema:t,path:h,value:f,message:`Expected array length to be greater or equal to ${t.minItems}`};if(r(t.maxItems)&&!(f.length<=t.maxItems))yield{type:q.ArrayMinItems,schema:t,path:h,value:f,message:`Expected array length to be less or equal to ${t.maxItems}`};for(let ce=0;ce<f.length;ce++)yield*ee(t.items,c,`${h}/${ce}`,f[ce]);if(t.uniqueItems===!0&&!function(){const ce=new Set;for(let se of f){const he=re.Hash(se);if(ce.has(he))return!1;else ce.add(he)}return!0}())yield{type:q.ArrayUniqueItems,schema:t,path:h,value:f,message:"Expected array elements to be unique"};if(!(r(t.contains)||n(t.minContains)||n(t.maxContains)))return;const w=r(t.contains)?t.contains:J.Type.Never(),z=f.reduce((ce,se,he)=>ee(w,c,`${h}${he}`,se).next().done===!0?ce+1:ce,0);if(z===0)yield{type:q.ArrayContains,schema:t,path:h,value:f,message:"Expected array to contain at least one matching type"};if(te.IsNumber(t.minContains)&&z<t.minContains)yield{type:q.ArrayMinContains,schema:t,path:h,value:f,message:`Expected array to contain at least ${t.minContains} matching types`};if(te.IsNumber(t.maxContains)&&z>t.maxContains)yield{type:q.ArrayMaxContains,schema:t,path:h,value:f,message:`Expected array to contain no more than ${t.maxContains} matching types`}}function*b(t,c,h,f){if(!te.IsAsyncIterator(f))yield{type:q.AsyncIterator,schema:t,path:h,value:f,message:"Expected value to be an async iterator"}}function*P(t,c,h,f){if(!te.IsBigInt(f))return yield{type:q.BigInt,schema:t,path:h,value:f,message:"Expected bigint"};if(r(t.multipleOf)&&f%t.multipleOf!==BigInt(0))yield{type:q.BigIntMultipleOf,schema:t,path:h,value:f,message:`Expected bigint to be a multiple of ${t.multipleOf}`};if(r(t.exclusiveMinimum)&&!(f>t.exclusiveMinimum))yield{type:q.BigIntExclusiveMinimum,schema:t,path:h,value:f,message:`Expected bigint to be greater than ${t.exclusiveMinimum}`};if(r(t.exclusiveMaximum)&&!(f<t.exclusiveMaximum))yield{type:q.BigIntExclusiveMaximum,schema:t,path:h,value:f,message:`Expected bigint to be less than ${t.exclusiveMaximum}`};if(r(t.minimum)&&!(f>=t.minimum))yield{type:q.BigIntMinimum,schema:t,path:h,value:f,message:`Expected bigint to be greater or equal to ${t.minimum}`};if(r(t.maximum)&&!(f<=t.maximum))yield{type:q.BigIntMaximum,schema:t,path:h,value:f,message:`Expected bigint to be less or equal to ${t.maximum}`}}function*G(t,c,h,f){if(!te.IsBoolean(f))return yield{type:q.Boolean,schema:t,path:h,value:f,message:"Expected boolean"}}function*x(t,c,h,f){yield*ee(t.returns,c,h,f.prototype)}function*F(t,c,h,f){if(!te.IsDate(f))return yield{type:q.Date,schema:t,path:h,value:f,message:"Expected Date object"};if(!isFinite(f.getTime()))return yield{type:q.Date,schema:t,path:h,value:f,message:"Invalid Date"};if(r(t.exclusiveMinimumTimestamp)&&!(f.getTime()>t.exclusiveMinimumTimestamp))yield{type:q.DateExclusiveMinimumTimestamp,schema:t,path:h,value:f,message:`Expected Date timestamp to be greater than ${t.exclusiveMinimum}`};if(r(t.exclusiveMaximumTimestamp)&&!(f.getTime()<t.exclusiveMaximumTimestamp))yield{type:q.DateExclusiveMaximumTimestamp,schema:t,path:h,value:f,message:`Expected Date timestamp to be less than ${t.exclusiveMaximum}`};if(r(t.minimumTimestamp)&&!(f.getTime()>=t.minimumTimestamp))yield{type:q.DateMinimumTimestamp,schema:t,path:h,value:f,message:`Expected Date timestamp to be greater or equal to ${t.minimum}`};if(r(t.maximumTimestamp)&&!(f.getTime()<=t.maximumTimestamp))yield{type:q.DateMaximumTimestamp,schema:t,path:h,value:f,message:`Expected Date timestamp to be less or equal to ${t.maximum}`}}function*N(t,c,h,f){if(!te.IsFunction(f))return yield{type:q.Function,schema:t,path:h,value:f,message:"Expected function"}}function*O(t,c,h,f){if(!te.IsInteger(f))return yield{type:q.Integer,schema:t,path:h,value:f,message:"Expected integer"};if(r(t.multipleOf)&&f%t.multipleOf!==0)yield{type:q.IntegerMultipleOf,schema:t,path:h,value:f,message:`Expected integer to be a multiple of ${t.multipleOf}`};if(r(t.exclusiveMinimum)&&!(f>t.exclusiveMinimum))yield{type:q.IntegerExclusiveMinimum,schema:t,path:h,value:f,message:`Expected integer to be greater than ${t.exclusiveMinimum}`};if(r(t.exclusiveMaximum)&&!(f<t.exclusiveMaximum))yield{type:q.IntegerExclusiveMaximum,schema:t,path:h,value:f,message:`Expected integer to be less than ${t.exclusiveMaximum}`};if(r(t.minimum)&&!(f>=t.minimum))yield{type:q.IntegerMinimum,schema:t,path:h,value:f,message:`Expected integer to be greater or equal to ${t.minimum}`};if(r(t.maximum)&&!(f<=t.maximum))yield{type:q.IntegerMaximum,schema:t,path:h,value:f,message:`Expected integer to be less or equal to ${t.maximum}`}}function*U(t,c,h,f){for(let w of t.allOf){const z=ee(w,c,h,f).next();if(!z.done){yield z.value,yield{type:q.Intersect,schema:t,path:h,value:f,message:"Expected all sub schemas to be valid"};return}}if(t.unevaluatedProperties===!1){const w=new RegExp(J.KeyResolver.ResolvePattern(t));for(let z of Object.getOwnPropertyNames(f))if(!w.test(z))yield{type:q.IntersectUnevaluatedProperties,schema:t,path:`${h}/${z}`,value:f,message:"Unexpected property"}}if(typeof t.unevaluatedProperties==="object"){const w=new RegExp(J.KeyResolver.ResolvePattern(t));for(let z of Object.getOwnPropertyNames(f))if(!w.test(z)){const ce=ee(t.unevaluatedProperties,c,`${h}/${z}`,f[z]).next();if(!ce.done){yield ce.value,yield{type:q.IntersectUnevaluatedProperties,schema:t,path:`${h}/${z}`,value:f,message:"Invalid additional property"};return}}}}function*A(t,c,h,f){if(!(a(f)&&(Symbol.iterator in f)))yield{type:q.Iterator,schema:t,path:h,value:f,message:"Expected value to be an iterator"}}function*j(t,c,h,f){if(f!==t.const){const w=typeof t.const==="string"?`'${t.const}'`:t.const;return yield{type:q.Literal,schema:t,path:h,value:f,message:`Expected ${w}`}}}function*I(t,c,h,f){yield{type:q.Never,schema:t,path:h,value:f,message:"Value cannot be validated"}}function*W(t,c,h,f){if(ee(t.not,c,h,f).next().done===!0)yield{type:q.Not,schema:t,path:h,value:f,message:"Value should not validate"}}function*B(t,c,h,f){if(!te.IsNull(f))return yield{type:q.Null,schema:t,path:h,value:f,message:"Expected null"}}function*ue(t,c,h,f){if(!n(f))return yield{type:q.Number,schema:t,path:h,value:f,message:"Expected number"};if(r(t.multipleOf)&&f%t.multipleOf!==0)yield{type:q.NumberMultipleOf,schema:t,path:h,value:f,message:`Expected number to be a multiple of ${t.multipleOf}`};if(r(t.exclusiveMinimum)&&!(f>t.exclusiveMinimum))yield{type:q.NumberExclusiveMinimum,schema:t,path:h,value:f,message:`Expected number to be greater than ${t.exclusiveMinimum}`};if(r(t.exclusiveMaximum)&&!(f<t.exclusiveMaximum))yield{type:q.NumberExclusiveMaximum,schema:t,path:h,value:f,message:`Expected number to be less than ${t.exclusiveMaximum}`};if(r(t.minimum)&&!(f>=t.minimum))yield{type:q.NumberMinimum,schema:t,path:h,value:f,message:`Expected number to be greater or equal to ${t.minimum}`};if(r(t.maximum)&&!(f<=t.maximum))yield{type:q.NumberMaximum,schema:t,path:h,value:f,message:`Expected number to be less or equal to ${t.maximum}`}}function*Ve(t,c,h,f){if(!a(f))return yield{type:q.Object,schema:t,path:h,value:f,message:"Expected object"};if(r(t.minProperties)&&!(Object.getOwnPropertyNames(f).length>=t.minProperties))yield{type:q.ObjectMinProperties,schema:t,path:h,value:f,message:`Expected object to have at least ${t.minProperties} properties`};if(r(t.maxProperties)&&!(Object.getOwnPropertyNames(f).length<=t.maxProperties))yield{type:q.ObjectMaxProperties,schema:t,path:h,value:f,message:`Expected object to have no more than ${t.maxProperties} properties`};const w=Array.isArray(t.required)?t.required:[],z=Object.getOwnPropertyNames(t.properties),ce=Object.getOwnPropertyNames(f);for(let se of z){const he=t.properties[se];if(t.required&&t.required.includes(se)){if(yield*ee(he,c,`${h}/${se}`,f[se]),J.ExtendsUndefined.Check(t)&&!(se in f))yield{type:q.ObjectRequiredProperties,schema:he,path:`${h}/${se}`,value:void 0,message:"Expected required property"}}else if(s(f,se))yield*ee(he,c,`${h}/${se}`,f[se])}for(let se of w){if(ce.includes(se))continue;yield{type:q.ObjectRequiredProperties,schema:t.properties[se],path:`${h}/${se}`,value:void 0,message:"Expected required property"}}if(t.additionalProperties===!1){for(let se of ce)if(!z.includes(se))yield{type:q.ObjectAdditionalProperties,schema:t,path:`${h}/${se}`,value:f[se],message:"Unexpected property"}}if(typeof t.additionalProperties==="object")for(let se of ce){if(z.includes(se))continue;yield*ee(t.additionalProperties,c,`${h}/${se}`,f[se])}}function*ae(t,c,h,f){if(!te.IsPromise(f))yield{type:q.Promise,schema:t,path:h,value:f,message:"Expected Promise"}}function*Z(t,c,h,f){if(!T(f))return yield{type:q.Object,schema:t,path:h,value:f,message:"Expected record object"};if(r(t.minProperties)&&!(Object.getOwnPropertyNames(f).length>=t.minProperties))yield{type:q.ObjectMinProperties,schema:t,path:h,value:f,message:`Expected object to have at least ${t.minProperties} properties`};if(r(t.maxProperties)&&!(Object.getOwnPropertyNames(f).length<=t.maxProperties))yield{type:q.ObjectMaxProperties,schema:t,path:h,value:f,message:`Expected object to have no more than ${t.maxProperties} properties`};const[w,z]=Object.entries(t.patternProperties)[0],ce=new RegExp(w);for(let[se,he]of Object.entries(f)){if(ce.test(se)){yield*ee(z,c,`${h}/${se}`,he);continue}if(typeof t.additionalProperties==="object")yield*ee(t.additionalProperties,c,`${h}/${se}`,he);if(t.additionalProperties===!1){const pe=`${h}/${se}`,Re=`Unexpected property '${pe}'`;return yield{type:q.ObjectAdditionalProperties,schema:t,path:pe,value:he,message:Re}}}}function*de(t,c,h,f){const w=c.findIndex((ce)=>ce.$id===t.$ref);if(w===-1)throw new i(t);const z=c[w];yield*ee(z,c,h,f)}function*d(t,c,h,f){if(!te.IsString(f))return yield{type:q.String,schema:t,path:h,value:f,message:"Expected string"};if(r(t.minLength)&&!(f.length>=t.minLength))yield{type:q.StringMinLength,schema:t,path:h,value:f,message:`Expected string length greater or equal to ${t.minLength}`};if(r(t.maxLength)&&!(f.length<=t.maxLength))yield{type:q.StringMaxLength,schema:t,path:h,value:f,message:`Expected string length less or equal to ${t.maxLength}`};if(te.IsString(t.pattern)){if(!new RegExp(t.pattern).test(f))yield{type:q.StringPattern,schema:t,path:h,value:f,message:`Expected string to match pattern ${t.pattern}`}}if(te.IsString(t.format)){if(!J.FormatRegistry.Has(t.format))yield{type:q.StringFormatUnknown,schema:t,path:h,value:f,message:`Unknown string format '${t.format}'`};else if(!J.FormatRegistry.Get(t.format)(f))yield{type:q.StringFormat,schema:t,path:h,value:f,message:`Expected string to match format '${t.format}'`}}}function*g(t,c,h,f){if(!te.IsSymbol(f))return yield{type:q.Symbol,schema:t,path:h,value:f,message:"Expected symbol"}}function*S(t,c,h,f){if(!te.IsString(f))return yield{type:q.String,schema:t,path:h,value:f,message:"Expected string"};if(!new RegExp(t.pattern).test(f))yield{type:q.StringPattern,schema:t,path:h,value:f,message:`Expected string to match pattern ${t.pattern}`}}function*k(t,c,h,f){const w=c.findIndex((ce)=>ce.$id===t.$ref);if(w===-1)throw new i(t);const z=c[w];yield*ee(z,c,h,f)}function*K(t,c,h,f){if(!te.IsArray(f))return yield{type:q.Array,schema:t,path:h,value:f,message:"Expected Array"};if(t.items===void 0&&f.length!==0)return yield{type:q.TupleZeroLength,schema:t,path:h,value:f,message:"Expected tuple to have 0 elements"};if(f.length!==t.maxItems)yield{type:q.TupleLength,schema:t,path:h,value:f,message:`Expected tuple to have ${t.maxItems} elements`};if(!t.items)return;for(let w=0;w<t.items.length;w++)yield*ee(t.items[w],c,`${h}/${w}`,f[w])}function*R(t,c,h,f){if(f!==void 0)yield{type:q.Undefined,schema:t,path:h,value:f,message:"Expected undefined"}}function*H(t,c,h,f){const w=[];for(let z of t.anyOf){const ce=[...ee(z,c,h,f)];if(ce.length===0)return;w.push(...ce)}if(w.length>0)yield{type:q.Union,schema:t,path:h,value:f,message:"Expected value of union"};for(let z of w)yield z}function*Q(t,c,h,f){if(!te.IsUint8Array(f))return yield{type:q.Uint8Array,schema:t,path:h,value:f,message:"Expected Uint8Array"};if(r(t.maxByteLength)&&!(f.length<=t.maxByteLength))yield{type:q.Uint8ArrayMaxByteLength,schema:t,path:h,value:f,message:`Expected Uint8Array to have a byte length less or equal to ${t.maxByteLength}`};if(r(t.minByteLength)&&!(f.length>=t.minByteLength))yield{type:q.Uint8ArrayMinByteLength,schema:t,path:h,value:f,message:`Expected Uint8Array to have a byte length greater or equal to ${t.maxByteLength}`}}function*X(t,c,h,f){}function*_(t,c,h,f){if(!E(f))return yield{type:q.Void,schema:t,path:h,value:f,message:"Expected void"}}function*Y(t,c,h,f){if(!J.TypeRegistry.Get(t[J.Kind])(t,f))return yield{type:q.Kind,schema:t,path:h,value:f,message:`Expected kind ${t[J.Kind]}`}}function*ee(t,c,h,f){const w=r(t.$id)?[...c,t]:c,z=t;switch(z[J.Kind]){case"Any":return yield*o(z,w,h,f);case"Array":return yield*C(z,w,h,f);case"AsyncIterator":return yield*b(z,w,h,f);case"BigInt":return yield*P(z,w,h,f);case"Boolean":return yield*G(z,w,h,f);case"Constructor":return yield*x(z,w,h,f);case"Date":return yield*F(z,w,h,f);case"Function":return yield*N(z,w,h,f);case"Integer":return yield*O(z,w,h,f);case"Intersect":return yield*U(z,w,h,f);case"Iterator":return yield*A(z,w,h,f);case"Literal":return yield*j(z,w,h,f);case"Never":return yield*I(z,w,h,f);case"Not":return yield*W(z,w,h,f);case"Null":return yield*B(z,w,h,f);case"Number":return yield*ue(z,w,h,f);case"Object":return yield*Ve(z,w,h,f);case"Promise":return yield*ae(z,w,h,f);case"Record":return yield*Z(z,w,h,f);case"Ref":return yield*de(z,w,h,f);case"String":return yield*d(z,w,h,f);case"Symbol":return yield*g(z,w,h,f);case"TemplateLiteral":return yield*S(z,w,h,f);case"This":return yield*k(z,w,h,f);case"Tuple":return yield*K(z,w,h,f);case"Undefined":return yield*R(z,w,h,f);case"Union":return yield*H(z,w,h,f);case"Uint8Array":return yield*Q(z,w,h,f);case"Unknown":return yield*X(z,w,h,f);case"Void":return yield*_(z,w,h,f);default:if(!J.TypeRegistry.Has(z[J.Kind]))throw new u(t);return yield*Y(z,w,h,f)}}var oe=function(...t){const c=t.length===3?ee(t[0],t[1],"",t[2]):ee(t[0],[],"",t[1]);return new le(c)};Object.defineProperty(e,"__esModule",{value:!0}),e.Errors=e.ValueErrorsDereferenceError=e.ValueErrorsUnknownTypeError=e.ValueErrorIterator=e.ValueErrorType=void 0;var M=it(),J=Pe(),re=st(),te=Ge(),q;(function(t){t[t.Array=0]="Array",t[t.ArrayMinItems=1]="ArrayMinItems",t[t.ArrayMaxItems=2]="ArrayMaxItems",t[t.ArrayContains=3]="ArrayContains",t[t.ArrayMinContains=4]="ArrayMinContains",t[t.ArrayMaxContains=5]="ArrayMaxContains",t[t.ArrayUniqueItems=6]="ArrayUniqueItems",t[t.AsyncIterator=7]="AsyncIterator",t[t.BigInt=8]="BigInt",t[t.BigIntMultipleOf=9]="BigIntMultipleOf",t[t.BigIntExclusiveMinimum=10]="BigIntExclusiveMinimum",t[t.BigIntExclusiveMaximum=11]="BigIntExclusiveMaximum",t[t.BigIntMinimum=12]="BigIntMinimum",t[t.BigIntMaximum=13]="BigIntMaximum",t[t.Boolean=14]="Boolean",t[t.Date=15]="Date",t[t.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",t[t.DateExclusiveMaximumTimestamp=17]="DateExclusiveMaximumTimestamp",t[t.DateMinimumTimestamp=18]="DateMinimumTimestamp",t[t.DateMaximumTimestamp=19]="DateMaximumTimestamp",t[t.Function=20]="Function",t[t.Integer=21]="Integer",t[t.IntegerMultipleOf=22]="IntegerMultipleOf",t[t.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",t[t.IntegerExclusiveMaximum=24]="IntegerExclusiveMaximum",t[t.IntegerMinimum=25]="IntegerMinimum",t[t.IntegerMaximum=26]="IntegerMaximum",t[t.Intersect=27]="Intersect",t[t.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",t[t.Iterator=29]="Iterator",t[t.Literal=30]="Literal",t[t.Never=31]="Never",t[t.Not=32]="Not",t[t.Null=33]="Null",t[t.Number=34]="Number",t[t.NumberMultipleOf=35]="NumberMultipleOf",t[t.NumberExclusiveMinimum=36]="NumberExclusiveMinimum",t[t.NumberExclusiveMaximum=37]="NumberExclusiveMaximum",t[t.NumberMinimum=38]="NumberMinimum",t[t.NumberMaximum=39]="NumberMaximum",t[t.Object=40]="Object",t[t.ObjectMinProperties=41]="ObjectMinProperties",t[t.ObjectMaxProperties=42]="ObjectMaxProperties",t[t.ObjectAdditionalProperties=43]="ObjectAdditionalProperties",t[t.ObjectRequiredProperties=44]="ObjectRequiredProperties",t[t.Promise=45]="Promise",t[t.RecordKeyNumeric=46]="RecordKeyNumeric",t[t.RecordKeyString=47]="RecordKeyString",t[t.String=48]="String",t[t.StringMinLength=49]="StringMinLength",t[t.StringMaxLength=50]="StringMaxLength",t[t.StringPattern=51]="StringPattern",t[t.StringFormatUnknown=52]="StringFormatUnknown",t[t.StringFormat=53]="StringFormat",t[t.Symbol=54]="Symbol",t[t.TupleZeroLength=55]="TupleZeroLength",t[t.TupleLength=56]="TupleLength",t[t.Undefined=57]="Undefined",t[t.Union=58]="Union",t[t.Uint8Array=59]="Uint8Array",t[t.Uint8ArrayMinByteLength=60]="Uint8ArrayMinByteLength",t[t.Uint8ArrayMaxByteLength=61]="Uint8ArrayMaxByteLength",t[t.Void=62]="Void",t[t.Kind=63]="Kind"})(q||(e.ValueErrorType=q={}));class le{constructor(t){this.iterator=t}[Symbol.iterator](){return this.iterator}First(){const t=this.iterator.next();return t.done?void 0:t.value}}e.ValueErrorIterator=le;class u extends Error{constructor(t){super("ValueErrors: Unknown type");this.schema=t}}e.ValueErrorsUnknownTypeError=u;class i extends Error{constructor(t){super(`ValueErrors: Unable to dereference type with $id '${t.$ref}'`);this.schema=t}}e.ValueErrorsDereferenceError=i,e.Errors=oe}),ct=ge((e)=>{var r=e&&e.__createBinding||(Object.create?function(a,T,n,E){if(E===void 0)E=n;var o=Object.getOwnPropertyDescriptor(T,n);if(!o||("get"in o?!T.__esModule:o.writable||o.configurable))o={enumerable:!0,get:function(){return T[n]}};Object.defineProperty(a,E,o)}:function(a,T,n,E){if(E===void 0)E=n;a[E]=T[n]}),s=e&&e.__exportStar||function(a,T){for(var n in a)if(n!=="default"&&!Object.prototype.hasOwnProperty.call(T,n))r(T,a,n)};Object.defineProperty(e,"__esModule",{value:!0}),s(rr(),e)}),Tt=ge((e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ValuePointer=e.ValuePointerRootDeleteError=e.ValuePointerRootSetError=void 0;class r extends Error{constructor(T,n,E){super("ValuePointer: Cannot set root value");this.value=T,this.path=n,this.update=E}}e.ValuePointerRootSetError=r;class s extends Error{constructor(T,n){super("ValuePointer: Cannot delete root value");this.value=T,this.path=n}}e.ValuePointerRootDeleteError=s;var a;(function(T){function n(G){return G.indexOf("~")===-1?G:G.replace(/~1/g,"/").replace(/~0/g,"~")}function*E(G){if(G==="")return;let[x,F]=[0,0];for(let N=0;N<G.length;N++)if(G.charAt(N)==="/")if(N===0)x=N+1;else F=N,yield n(G.slice(x,F)),x=N+1;else F=N;yield n(G.slice(x))}T.Format=E;function o(G,x,F){if(x==="")throw new r(G,x,F);let[N,O,U]=[null,G,""];for(let A of E(x)){if(O[A]===void 0)O[A]={};N=O,O=O[A],U=A}N[U]=F}T.Set=o;function C(G,x){if(x==="")throw new s(G,x);let[F,N,O]=[null,G,""];for(let U of E(x)){if(N[U]===void 0||N[U]===null)return;F=N,N=N[U],O=U}if(Array.isArray(F)){const U=parseInt(O);F.splice(U,1)}else delete F[O]}T.Delete=C;function b(G,x){if(x==="")return!0;let[F,N,O]=[null,G,""];for(let U of E(x)){if(N[U]===void 0)return!1;F=N,N=N[U],O=U}return Object.getOwnPropertyNames(F).includes(O)}T.Has=b;function P(G,x){if(x==="")return G;let F=G;for(let N of E(x)){if(F[N]===void 0)return;F=F[N]}return F}T.Get=P})(a||(e.ValuePointer=a={}))}),tt=ge((e)=>{var r=function(x){return[...Object.getOwnPropertyNames(x),...Object.getOwnPropertySymbols(x)].reduce((F,N)=>({...F,[N]:P(x[N])}),{})},s=function(x){return x.map((F)=>P(F))},a=function(x){return x.slice()},T=function(x){return new Date(x.toISOString())},n=function(x){return x},E=function(x){return x},o=function(x){return x},C=function(x){return x},b=function(x){return x},P=function(x){if(G.IsArray(x))return s(x);if(G.IsAsyncIterator(x))return E(x);if(G.IsFunction(x))return C(x);if(G.IsIterator(x))return o(x);if(G.IsPromise(x))return b(x);if(G.IsDate(x))return T(x);if(G.IsPlainObject(x))return r(x);if(G.IsTypedArray(x))return a(x);if(G.IsValueType(x))return n(x);throw new Error("ValueClone: Unable to clone value")};Object.defineProperty(e,"__esModule",{value:!0}),e.Clone=void 0;var G=Ge();e.Clone=P}),Ot=ge((e)=>{var r=function(I,W){return{type:"update",path:I,value:W}},s=function(I,W){return{type:"insert",path:I,value:W}},a=function(I){return{type:"delete",path:I}};function*T(I,W,B){if(!O.IsPlainObject(B))return yield r(I,B);const ue=[...Object.keys(W),...Object.getOwnPropertySymbols(W)],Ve=[...Object.keys(B),...Object.getOwnPropertySymbols(B)];for(let ae of ue){if(O.IsSymbol(ae))throw new A(ae);if(O.IsUndefined(B[ae])&&Ve.includes(ae))yield r(`${I}/${String(ae)}`,void 0)}for(let ae of Ve){if(O.IsUndefined(W[ae])||O.IsUndefined(B[ae]))continue;if(O.IsSymbol(ae))throw new A(ae);yield*C(`${I}/${String(ae)}`,W[ae],B[ae])}for(let ae of Ve){if(O.IsSymbol(ae))throw new A(ae);if(O.IsUndefined(W[ae]))yield s(`${I}/${String(ae)}`,B[ae])}for(let ae of ue.reverse()){if(O.IsSymbol(ae))throw new A(ae);if(O.IsUndefined(B[ae])&&!Ve.includes(ae))yield a(`${I}/${String(ae)}`)}}function*n(I,W,B){if(!O.IsArray(B))return yield r(I,B);for(let ue=0;ue<Math.min(W.length,B.length);ue++)yield*C(`${I}/${ue}`,W[ue],B[ue]);for(let ue=0;ue<B.length;ue++){if(ue<W.length)continue;yield s(`${I}/${ue}`,B[ue])}for(let ue=W.length-1;ue>=0;ue--){if(ue<B.length)continue;yield a(`${I}/${ue}`)}}function*E(I,W,B){if(!O.IsTypedArray(B)||W.length!==B.length||Object.getPrototypeOf(W).constructor.name!==Object.getPrototypeOf(B).constructor.name)return yield r(I,B);for(let ue=0;ue<Math.min(W.length,B.length);ue++)yield*C(`${I}/${ue}`,W[ue],B[ue])}function*o(I,W,B){if(W===B)return;yield r(I,B)}function*C(I,W,B){if(O.IsPlainObject(W))return yield*T(I,W,B);if(O.IsArray(W))return yield*n(I,W,B);if(O.IsTypedArray(W))return yield*E(I,W,B);if(O.IsValueType(W))return yield*o(I,W,B);throw new j(W)}var b=function(I,W){return[...C("",I,W)]},P=function(I){return I.length>0&&I[0].path===""&&I[0].type==="update"},G=function(I){return I.length===0},x=function(I,W){if(P(W))return U.Clone(W[0].value);if(G(W))return U.Clone(I);const B=U.Clone(I);for(let ue of W)switch(ue.type){case"insert":{N.ValuePointer.Set(B,ue.path,ue.value);break}case"update":{N.ValuePointer.Set(B,ue.path,ue.value);break}case"delete":{N.ValuePointer.Delete(B,ue.path);break}}return B};Object.defineProperty(e,"__esModule",{value:!0}),e.Patch=e.Diff=e.ValueDeltaUnableToDiffUnknownValue=e.ValueDeltaObjectWithSymbolKeyError=e.Edit=e.Delete=e.Update=e.Insert=void 0;var F=Pe(),N=Tt(),O=Ge(),U=tt();e.Insert=F.Type.Object({type:F.Type.Literal("insert"),path:F.Type.String(),value:F.Type.Unknown()}),e.Update=F.Type.Object({type:F.Type.Literal("update"),path:F.Type.String(),value:F.Type.Unknown()}),e.Delete=F.Type.Object({type:F.Type.Literal("delete"),path:F.Type.String()}),e.Edit=F.Type.Union([e.Insert,e.Update,e.Delete]);class A extends Error{constructor(I){super("ValueDelta: Cannot diff objects with symbol keys");this.key=I}}e.ValueDeltaObjectWithSymbolKeyError=A;class j extends Error{constructor(I){super("ValueDelta: Unable to create diff edits for unknown value");this.value=I}}e.ValueDeltaUnableToDiffUnknownValue=j,e.Diff=b,e.Patch=x}),nr=ge((e)=>{var r=function(N,O,U,A){if(!G.IsPlainObject(U))b.ValuePointer.Set(N,O,P.Clone(A));else{const j=Object.keys(U),I=Object.keys(A);for(let W of j)if(!I.includes(W))delete U[W];for(let W of I)if(!j.includes(W))U[W]=null;for(let W of I)n(N,`${O}/${W}`,U[W],A[W])}},s=function(N,O,U,A){if(!G.IsArray(U))b.ValuePointer.Set(N,O,P.Clone(A));else{for(let j=0;j<A.length;j++)n(N,`${O}/${j}`,U[j],A[j]);U.splice(A.length)}},a=function(N,O,U,A){if(G.IsTypedArray(U)&&U.length===A.length)for(let j=0;j<U.length;j++)U[j]=A[j];else b.ValuePointer.Set(N,O,P.Clone(A))},T=function(N,O,U,A){if(U===A)return;b.ValuePointer.Set(N,O,A)},n=function(N,O,U,A){if(G.IsArray(A))return s(N,O,U,A);if(G.IsTypedArray(A))return a(N,O,U,A);if(G.IsPlainObject(A))return r(N,O,U,A);if(G.IsValueType(A))return T(N,O,U,A)},E=function(N){return G.IsTypedArray(N)||G.IsValueType(N)},o=function(N,O){return G.IsPlainObject(N)&&G.IsArray(O)||G.IsArray(N)&&G.IsPlainObject(O)},C=function(N,O){if(E(N)||E(O))throw new F;if(o(N,O))throw new x;n(N,"",N,O)};Object.defineProperty(e,"__esModule",{value:!0}),e.Mutate=e.ValueMutateInvalidRootMutationError=e.ValueMutateTypeMismatchError=void 0;var b=Tt(),P=tt(),G=Ge();class x extends Error{constructor(){super("ValueMutate: Cannot assign due type mismatch of assignable values")}}e.ValueMutateTypeMismatchError=x;class F extends Error{constructor(){super("ValueMutate: Only object and array types can be mutated at the root level")}}e.ValueMutateInvalidRootMutationError=F,e.Mutate=C}),ar=ge((e)=>{var r=function(C,b){if(!o.IsPlainObject(b))return!1;const P=[...Object.keys(C),...Object.getOwnPropertySymbols(C)],G=[...Object.keys(b),...Object.getOwnPropertySymbols(b)];if(P.length!==G.length)return!1;return P.every((x)=>E(C[x],b[x]))},s=function(C,b){return o.IsDate(b)&&C.getTime()===b.getTime()},a=function(C,b){if(!o.IsArray(b)||C.length!==b.length)return!1;return C.every((P,G)=>E(P,b[G]))},T=function(C,b){if(!o.IsTypedArray(b)||C.length!==b.length||Object.getPrototypeOf(C).constructor.name!==Object.getPrototypeOf(b).constructor.name)return!1;return C.every((P,G)=>E(P,b[G]))},n=function(C,b){return C===b},E=function(C,b){if(o.IsPlainObject(C))return r(C,b);if(o.IsDate(C))return s(C,b);if(o.IsTypedArray(C))return T(C,b);if(o.IsArray(C))return a(C,b);if(o.IsValueType(C))return n(C,b);throw new Error("ValueEquals: Unable to compare value")};Object.defineProperty(e,"__esModule",{value:!0}),e.Equal=void 0;var o=Ge();e.Equal=E}),ut=ge((e)=>{var r=function(i){return i[re.Kind]==="Any"||i[re.Kind]==="Unknown"},s=function(i){return i!==void 0},a=function(i,t){return J.TypeSystem.ExactOptionalPropertyTypes?t in i:i[t]!==void 0},T=function(i){const t=te.IsObject(i);return J.TypeSystem.AllowArrayObjects?t:t&&!te.IsArray(i)},n=function(i){return T(i)&&!(i instanceof Date)&&!(i instanceof Uint8Array)},E=function(i){const t=te.IsNumber(i);return J.TypeSystem.AllowNaN?t:t&&Number.isFinite(i)},o=function(i){const t=te.IsUndefined(i);return J.TypeSystem.AllowVoidNull?t||i===null:t},C=function(i,t,c){return!0},b=function(i,t,c){if(!Array.isArray(c))return!1;if(s(i.minItems)&&!(c.length>=i.minItems))return!1;if(s(i.maxItems)&&!(c.length<=i.maxItems))return!1;if(!c.every((w)=>oe(i.items,t,w)))return!1;if(i.uniqueItems===!0&&!function(){const w=new Set;for(let z of c){const ce=q.Hash(z);if(w.has(ce))return!1;else w.add(ce)}return!0}())return!1;if(!(s(i.contains)||E(i.minContains)||E(i.maxContains)))return!0;const h=s(i.contains)?i.contains:re.Type.Never(),f=c.reduce((w,z)=>oe(h,t,z)?w+1:w,0);if(f===0)return!1;if(E(i.minContains)&&f<i.minContains)return!1;if(E(i.maxContains)&&f>i.maxContains)return!1;return!0},P=function(i,t,c){return T(c)&&(Symbol.asyncIterator in c)},G=function(i,t,c){if(!te.IsBigInt(c))return!1;if(s(i.multipleOf)&&c%i.multipleOf!==BigInt(0))return!1;if(s(i.exclusiveMinimum)&&!(c>i.exclusiveMinimum))return!1;if(s(i.exclusiveMaximum)&&!(c<i.exclusiveMaximum))return!1;if(s(i.minimum)&&!(c>=i.minimum))return!1;if(s(i.maximum)&&!(c<=i.maximum))return!1;return!0},x=function(i,t,c){return typeof c==="boolean"},F=function(i,t,c){return oe(i.returns,t,c.prototype)},N=function(i,t,c){if(!(c instanceof Date))return!1;if(!E(c.getTime()))return!1;if(s(i.exclusiveMinimumTimestamp)&&!(c.getTime()>i.exclusiveMinimumTimestamp))return!1;if(s(i.exclusiveMaximumTimestamp)&&!(c.getTime()<i.exclusiveMaximumTimestamp))return!1;if(s(i.minimumTimestamp)&&!(c.getTime()>=i.minimumTimestamp))return!1;if(s(i.maximumTimestamp)&&!(c.getTime()<=i.maximumTimestamp))return!1;return!0},O=function(i,t,c){return typeof c==="function"},U=function(i,t,c){if(!te.IsInteger(c))return!1;if(s(i.multipleOf)&&c%i.multipleOf!==0)return!1;if(s(i.exclusiveMinimum)&&!(c>i.exclusiveMinimum))return!1;if(s(i.exclusiveMaximum)&&!(c<i.exclusiveMaximum))return!1;if(s(i.minimum)&&!(c>=i.minimum))return!1;if(s(i.maximum)&&!(c<=i.maximum))return!1;return!0},A=function(i,t,c){const h=i.allOf.every((f)=>oe(f,t,c));if(i.unevaluatedProperties===!1){const f=new RegExp(re.KeyResolver.ResolvePattern(i)),w=Object.getOwnPropertyNames(c).every((z)=>f.test(z));return h&&w}else if(re.TypeGuard.TSchema(i.unevaluatedProperties)){const f=new RegExp(re.KeyResolver.ResolvePattern(i)),w=Object.getOwnPropertyNames(c).every((z)=>f.test(z)||oe(i.unevaluatedProperties,t,c[z]));return h&&w}else return h},j=function(i,t,c){return T(c)&&(Symbol.iterator in c)},I=function(i,t,c){return c===i.const},W=function(i,t,c){return!1},B=function(i,t,c){return!oe(i.not,t,c)},ue=function(i,t,c){return c===null},Ve=function(i,t,c){if(!E(c))return!1;if(s(i.multipleOf)&&c%i.multipleOf!==0)return!1;if(s(i.exclusiveMinimum)&&!(c>i.exclusiveMinimum))return!1;if(s(i.exclusiveMaximum)&&!(c<i.exclusiveMaximum))return!1;if(s(i.minimum)&&!(c>=i.minimum))return!1;if(s(i.maximum)&&!(c<=i.maximum))return!1;return!0},ae=function(i,t,c){if(!T(c))return!1;if(s(i.minProperties)&&!(Object.getOwnPropertyNames(c).length>=i.minProperties))return!1;if(s(i.maxProperties)&&!(Object.getOwnPropertyNames(c).length<=i.maxProperties))return!1;const h=Object.getOwnPropertyNames(i.properties);for(let f of h){const w=i.properties[f];if(i.required&&i.required.includes(f)){if(!oe(w,t,c[f]))return!1;if((re.ExtendsUndefined.Check(w)||r(w))&&!(f in c))return!1}else if(a(c,f)&&!oe(w,t,c[f]))return!1}if(i.additionalProperties===!1){const f=Object.getOwnPropertyNames(c);if(i.required&&i.required.length===h.length&&f.length===h.length)return!0;else return f.every((w)=>h.includes(w))}else if(typeof i.additionalProperties==="object")return Object.getOwnPropertyNames(c).every((f)=>h.includes(f)||oe(i.additionalProperties,t,c[f]));else return!0},Z=function(i,t,c){return typeof c==="object"&&typeof c.then==="function"},de=function(i,t,c){if(!n(c))return!1;if(s(i.minProperties)&&!(Object.getOwnPropertyNames(c).length>=i.minProperties))return!1;if(s(i.maxProperties)&&!(Object.getOwnPropertyNames(c).length<=i.maxProperties))return!1;const[h,f]=Object.entries(i.patternProperties)[0],w=new RegExp(h);return Object.entries(c).every(([z,ce])=>{if(w.test(z))return oe(f,t,ce);if(typeof i.additionalProperties==="object")return oe(i.additionalProperties,t,ce);if(i.additionalProperties===!1)return!1;return!0})},d=function(i,t,c){const h=t.findIndex((w)=>w.$id===i.$ref);if(h===-1)throw new u(i);const f=t[h];return oe(f,t,c)},g=function(i,t,c){if(!te.IsString(c))return!1;if(s(i.minLength)){if(!(c.length>=i.minLength))return!1}if(s(i.maxLength)){if(!(c.length<=i.maxLength))return!1}if(s(i.pattern)){if(!new RegExp(i.pattern).test(c))return!1}if(s(i.format)){if(!re.FormatRegistry.Has(i.format))return!1;return re.FormatRegistry.Get(i.format)(c)}return!0},S=function(i,t,c){if(typeof c!=="symbol")return!1;return!0},k=function(i,t,c){if(!te.IsString(c))return!1;return new RegExp(i.pattern).test(c)},K=function(i,t,c){const h=t.findIndex((w)=>w.$id===i.$ref);if(h===-1)throw new u(i);const f=t[h];return oe(f,t,c)},R=function(i,t,c){if(!te.IsArray(c))return!1;if(i.items===void 0&&c.length!==0)return!1;if(c.length!==i.maxItems)return!1;if(!i.items)return!0;for(let h=0;h<i.items.length;h++)if(!oe(i.items[h],t,c[h]))return!1;return!0},H=function(i,t,c){return c===void 0},Q=function(i,t,c){return i.anyOf.some((h)=>oe(h,t,c))},X=function(i,t,c){if(!(c instanceof Uint8Array))return!1;if(s(i.maxByteLength)&&!(c.length<=i.maxByteLength))return!1;if(s(i.minByteLength)&&!(c.length>=i.minByteLength))return!1;return!0},_=function(i,t,c){return!0},Y=function(i,t,c){return o(c)},ee=function(i,t,c){if(!re.TypeRegistry.Has(i[re.Kind]))return!1;return re.TypeRegistry.Get(i[re.Kind])(i,c)},oe=function(i,t,c){const h=s(i.$id)?[...t,i]:t,f=i;switch(f[re.Kind]){case"Any":return C(f,h,c);case"Array":return b(f,h,c);case"AsyncIterator":return P(f,h,c);case"BigInt":return G(f,h,c);case"Boolean":return x(f,h,c);case"Constructor":return F(f,h,c);case"Date":return N(f,h,c);case"Function":return O(f,h,c);case"Integer":return U(f,h,c);case"Intersect":return A(f,h,c);case"Iterator":return j(f,h,c);case"Literal":return I(f,h,c);case"Never":return W(f,h,c);case"Not":return B(f,h,c);case"Null":return ue(f,h,c);case"Number":return Ve(f,h,c);case"Object":return ae(f,h,c);case"Promise":return Z(f,h,c);case"Record":return de(f,h,c);case"Ref":return d(f,h,c);case"String":return g(f,h,c);case"Symbol":return S(f,h,c);case"TemplateLiteral":return k(f,h,c);case"This":return K(f,h,c);case"Tuple":return R(f,h,c);case"Undefined":return H(f,h,c);case"Union":return Q(f,h,c);case"Uint8Array":return X(f,h,c);case"Unknown":return _(f,h,c);case"Void":return Y(f,h,c);default:if(!re.TypeRegistry.Has(f[re.Kind]))throw new le(f);return ee(f,h,c)}},M=function(...i){return i.length===3?oe(i[0],i[1],i[2]):oe(i[0],[],i[1])};Object.defineProperty(e,"__esModule",{value:!0}),e.Check=e.ValueCheckDereferenceError=e.ValueCheckUnknownTypeError=void 0;var J=it(),re=Pe(),te=Ge(),q=st();class le extends Error{constructor(i){super(`ValueCheck: ${i[re.Kind]?`Unknown type '${i[re.Kind]}'`:"Unknown type"}`);this.schema=i}}e.ValueCheckUnknownTypeError=le;class u extends Error{constructor(i){super(`ValueCheck: Unable to dereference type with $id '${i.$ref}'`);this.schema=i}}e.ValueCheckDereferenceError=u,e.Check=M}),Gt=ge((e)=>{var r=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return{}},s=function(u,i){if(u.uniqueItems===!0&&!_.HasPropertyKey(u,"default"))throw new Error("ValueCreate.Array: Array with the uniqueItems constraint requires a default value");else if(("contains"in u)&&!_.HasPropertyKey(u,"default"))throw new Error("ValueCreate.Array: Array with the contains constraint requires a default value");else if("default"in u)return u.default;else if(u.minItems!==void 0)return Array.from({length:u.minItems}).map((t)=>{return R(u.items,i)});else return[]},a=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return async function*(){}()},T=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return BigInt(0)},n=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return!1},E=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else{const t=R(u.returns,i);if(typeof t==="object"&&!Array.isArray(t))return class{constructor(){for(let[c,h]of Object.entries(t)){const f=this;f[c]=h}}};else return class{}}},o=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else if(u.minimumTimestamp!==void 0)return new Date(u.minimumTimestamp);else return new Date(0)},C=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return()=>R(u.returns,i)},b=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else if(u.minimum!==void 0)return u.minimum;else return 0},P=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else{const t=u.allOf.reduce((c,h)=>{const f=R(h,i);return typeof f==="object"?{...c,...f}:f},{});if(!X.Check(u,i,t))throw new M(u);return t}},G=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return function*(){}()},x=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return u.const},F=function(u,i){throw new ee(u)},N=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else throw new oe(u)},O=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return null},U=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else if(u.minimum!==void 0)return u.minimum;else return 0},A=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else{const t=new Set(u.required);return u.default||Object.entries(u.properties).reduce((c,[h,f])=>{return t.has(h)?{...c,[h]:R(f,i)}:{...c}},{})}},j=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return Promise.resolve(R(u.item,i))},I=function(u,i){const[t,c]=Object.entries(u.patternProperties)[0];if(_.HasPropertyKey(u,"default"))return u.default;else if(!(t===Q.PatternStringExact||t===Q.PatternNumberExact))return t.slice(1,t.length-1).split("|").reduce((h,f)=>{return{...h,[f]:R(c,i)}},{});else return{}},W=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else{const t=i.findIndex((h)=>h.$id===u.$ref);if(t===-1)throw new re(u);const c=i[t];return R(c,i)}},B=function(u,i){if(u.pattern!==void 0)if(!_.HasPropertyKey(u,"default"))throw new Error("ValueCreate.String: String types with patterns must specify a default value");else return u.default;else if(u.format!==void 0)if(!_.HasPropertyKey(u,"default"))throw new Error("ValueCreate.String: String types with formats must specify a default value");else return u.default;else if(_.HasPropertyKey(u,"default"))return u.default;else if(u.minLength!==void 0)return Array.from({length:u.minLength}).map(()=>".").join("");else return""},ue=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else if("value"in u)return Symbol.for(u.value);else return Symbol()},Ve=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;const t=Q.TemplateLiteralParser.ParseExact(u.pattern);if(!Q.TemplateLiteralFinite.Check(t))throw new J(u);return Q.TemplateLiteralGenerator.Generate(t).next().value},ae=function(u,i){if(le++>q)throw new te(u,q);if(_.HasPropertyKey(u,"default"))return u.default;else{const t=i.findIndex((h)=>h.$id===u.$ref);if(t===-1)throw new re(u);const c=i[t];return R(c,i)}},Z=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;if(u.items===void 0)return[];else return Array.from({length:u.minItems}).map((t,c)=>R(u.items[c],i))},de=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return},d=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else if(u.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");else return R(u.anyOf[0],i)},g=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else if(u.minByteLength!==void 0)return new Uint8Array(u.minByteLength);else return new Uint8Array(0)},S=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return{}},k=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else return},K=function(u,i){if(_.HasPropertyKey(u,"default"))return u.default;else throw new Error("ValueCreate: User defined types must specify a default value")},R=function(u,i){const t=_.IsString(u.$id)?[...i,u]:i,c=u;switch(c[Q.Kind]){case"Any":return r(c,t);case"Array":return s(c,t);case"AsyncIterator":return a(c,t);case"BigInt":return T(c,t);case"Boolean":return n(c,t);case"Constructor":return E(c,t);case"Date":return o(c,t);case"Function":return C(c,t);case"Integer":return b(c,t);case"Intersect":return P(c,t);case"Iterator":return G(c,t);case"Literal":return x(c,t);case"Never":return F(c,t);case"Not":return N(c,t);case"Null":return O(c,t);case"Number":return U(c,t);case"Object":return A(c,t);case"Promise":return j(c,t);case"Record":return I(c,t);case"Ref":return W(c,t);case"String":return B(c,t);case"Symbol":return ue(c,t);case"TemplateLiteral":return Ve(c,t);case"This":return ae(c,t);case"Tuple":return Z(c,t);case"Undefined":return de(c,t);case"Union":return d(c,t);case"Uint8Array":return g(c,t);case"Unknown":return S(c,t);case"Void":return k(c,t);default:if(!Q.TypeRegistry.Has(c[Q.Kind]))throw new Y(c);return K(c,t)}},H=function(...u){return le=0,u.length===2?R(u[0],u[1]):R(u[0],[])};Object.defineProperty(e,"__esModule",{value:!0}),e.Create=e.ValueCreateRecursiveInstantiationError=e.ValueCreateDereferenceError=e.ValueCreateTempateLiteralTypeError=e.ValueCreateIntersectTypeError=e.ValueCreateNotTypeError=e.ValueCreateNeverTypeError=e.ValueCreateUnknownTypeError=void 0;var Q=Pe(),X=ut(),_=Ge();class Y extends Error{constructor(u){super("ValueCreate: Unknown type");this.schema=u}}e.ValueCreateUnknownTypeError=Y;class ee extends Error{constructor(u){super("ValueCreate: Never types cannot be created");this.schema=u}}e.ValueCreateNeverTypeError=ee;class oe extends Error{constructor(u){super("ValueCreate: Not types must have a default value");this.schema=u}}e.ValueCreateNotTypeError=oe;class M extends Error{constructor(u){super("ValueCreate: Intersect produced invalid value. Consider using a default value.");this.schema=u}}e.ValueCreateIntersectTypeError=M;class J extends Error{constructor(u){super("ValueCreate: Can only create template literal values from patterns that produce finite sequences. Consider using a default value.");this.schema=u}}e.ValueCreateTempateLiteralTypeError=J;class re extends Error{constructor(u){super(`ValueCreate: Unable to dereference type with $id '${u.$ref}'`);this.schema=u}}e.ValueCreateDereferenceError=re;class te extends Error{constructor(u,i){super("ValueCreate: Value cannot be created as recursive type may produce value of infinite size. Consider using a default.");this.schema=u,this.recursiveMaxDepth=i}}e.ValueCreateRecursiveInstantiationError=te;var q=512,le=0;e.Create=H}),ir=ge((e)=>{var r=function(u,i,t){return _.Check(u,i,t)?Y.Clone(t):X.Create(u,i)},s=function(u,i,t){if(_.Check(u,i,t))return Y.Clone(t);const c=ee.IsArray(t)?Y.Clone(t):X.Create(u,i),h=ee.IsNumber(u.minItems)&&c.length<u.minItems?[...c,...Array.from({length:u.minItems-c.length},()=>null)]:c,f=(ee.IsNumber(u.maxItems)&&h.length>u.maxItems?h.slice(0,u.maxItems):h).map((z)=>R(u.items,i,z));if(u.uniqueItems!==!0)return f;const w=[...new Set(f)];if(!_.Check(u,i,w))throw new M(u,w);return w},a=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},T=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},n=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},E=function(u,i,t){if(_.Check(u,i,t))return X.Create(u,i);const c=new Set(u.returns.required||[]),h=function(){};for(let[f,w]of Object.entries(u.returns.properties)){if(!c.has(f)&&t.prototype[f]===void 0)continue;h.prototype[f]=R(w,i,t.prototype[f])}return h},o=function(u,i,t){return _.Check(u,i,t)?Y.Clone(t):X.Create(u,i)},C=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},b=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},P=function(u,i,t){const c=X.Create(u,i),h=ee.IsPlainObject(c)&&ee.IsPlainObject(t)?{...c,...t}:t;return _.Check(u,i,h)?h:X.Create(u,i)},G=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},x=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},F=function(u,i,t){throw new J(u)},N=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},O=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},U=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},A=function(u,i,t){if(_.Check(u,i,t))return t;if(t===null||typeof t!=="object")return X.Create(u,i);const c=new Set(u.required||[]),h={};for(let[f,w]of Object.entries(u.properties)){if(!c.has(f)&&t[f]===void 0)continue;h[f]=R(w,i,t[f])}if(typeof u.additionalProperties==="object"){const f=Object.getOwnPropertyNames(u.properties);for(let w of Object.getOwnPropertyNames(t)){if(f.includes(w))continue;h[w]=R(u.additionalProperties,i,t[w])}}return h},j=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},I=function(u,i,t){if(_.Check(u,i,t))return Y.Clone(t);if(t===null||typeof t!=="object"||Array.isArray(t)||t instanceof Date)return X.Create(u,i);const c=Object.getOwnPropertyNames(u.patternProperties)[0],h=u.patternProperties[c],f={};for(let[w,z]of Object.entries(t))f[w]=R(h,i,z);return f},W=function(u,i,t){const c=i.findIndex((f)=>f.$id===u.$ref);if(c===-1)throw new q(u);const h=i[c];return R(h,i,t)},B=function(u,i,t){return _.Check(u,i,t)?t:X.Create(u,i)},ue=function(u,i,t){return _.Check(u,i,t)?Y.Clone(t):X.Create(u,i)},Ve=function(u,i,t){return _.Check(u,i,t)?Y.Clone(t):X.Create(u,i)},ae=function(u,i,t){const c=i.findIndex((f)=>f.$id===u.$ref);if(c===-1)throw new q(u);const h=i[c];return R(h,i,t)},Z=function(u,i,t){if(_.Check(u,i,t))return Y.Clone(t);if(!ee.IsArray(t))return X.Create(u,i);if(u.items===void 0)return[];return u.items.map((c,h)=>R(c,i,t[h]))},de=function(u,i,t){return _.Check(u,i,t)?Y.Clone(t):X.Create(u,i)},d=function(u,i,t){return _.Check(u,i,t)?Y.Clone(t):le.Create(u,i,t)},g=function(u,i,t){return _.Check(u,i,t)?Y.Clone(t):X.Create(u,i)},S=function(u,i,t){return _.Check(u,i,t)?Y.Clone(t):X.Create(u,i)},k=function(u,i,t){return _.Check(u,i,t)?Y.Clone(t):X.Create(u,i)},K=function(u,i,t){return _.Check(u,i,t)?Y.Clone(t):X.Create(u,i)},R=function(u,i,t){const c=ee.IsString(u.$id)?[...i,u]:i,h=u;switch(u[Q.Kind]){case"Any":return r(h,c,t);case"Array":return s(h,c,t);case"AsyncIterator":return a(h,c,t);case"BigInt":return T(h,c,t);case"Boolean":return n(h,c,t);case"Constructor":return E(h,c,t);case"Date":return o(h,c,t);case"Function":return C(h,c,t);case"Integer":return b(h,c,t);case"Intersect":return P(h,c,t);case"Iterator":return G(h,c,t);case"Literal":return x(h,c,t);case"Never":return F(h,c,t);case"Not":return N(h,c,t);case"Null":return O(h,c,t);case"Number":return U(h,c,t);case"Object":return A(h,c,t);case"Promise":return j(h,c,t);case"Record":return I(h,c,t);case"Ref":return W(h,c,t);case"String":return B(h,c,t);case"Symbol":return ue(h,c,t);case"TemplateLiteral":return Ve(h,c,t);case"This":return ae(h,c,t);case"Tuple":return Z(h,c,t);case"Undefined":return de(h,c,t);case"Union":return d(h,c,t);case"Uint8Array":return g(h,c,t);case"Unknown":return S(h,c,t);case"Void":return k(h,c,t);default:if(!Q.TypeRegistry.Has(h[Q.Kind]))throw new te(h);return K(h,c,t)}},H=function(...u){return u.length===3?R(u[0],u[1],u[2]):R(u[0],[],u[1])};Object.defineProperty(e,"__esModule",{value:!0}),e.Cast=e.ValueCastDereferenceError=e.ValueCastUnknownTypeError=e.ValueCastRecursiveTypeError=e.ValueCastNeverTypeError=e.ValueCastArrayUniqueItemsTypeError=e.ValueCastReferenceTypeError=void 0;var Q=Pe(),X=Gt(),_=ut(),Y=tt(),ee=Ge();class oe extends Error{constructor(u){super(`ValueCast: Cannot locate referenced schema with $id '${u.$ref}'`);this.schema=u}}e.ValueCastReferenceTypeError=oe;class M extends Error{constructor(u,i){super("ValueCast: Array cast produced invalid data due to uniqueItems constraint");this.schema=u,this.value=i}}e.ValueCastArrayUniqueItemsTypeError=M;class J extends Error{constructor(u){super("ValueCast: Never types cannot be cast");this.schema=u}}e.ValueCastNeverTypeError=J;class re extends Error{constructor(u){super("ValueCast.Recursive: Cannot cast recursive schemas");this.schema=u}}e.ValueCastRecursiveTypeError=re;class te extends Error{constructor(u){super("ValueCast: Unknown type");this.schema=u}}e.ValueCastUnknownTypeError=te;class q extends Error{constructor(u){super(`ValueCast: Unable to dereference type with $id '${u.$ref}'`);this.schema=u}}e.ValueCastDereferenceError=q;var le;(function(u){function i(h,f,w){if(h[Q.Kind]==="Object"&&typeof w==="object"&&!ee.IsNull(w)){const z=h,ce=Object.getOwnPropertyNames(w),se=Object.entries(z.properties),[he,pe]=[1/se.length,se.length];return se.reduce((Re,[Se,V])=>{const ie=V[Q.Kind]==="Literal"&&V.const===w[Se]?pe:0,m=_.Check(V,f,w[Se])?he:0,v=ce.includes(Se)?he:0;return Re+(ie+m+v)},0)}else return _.Check(h,f,w)?1:0}function t(h,f,w){let[z,ce]=[h.anyOf[0],0];for(let se of h.anyOf){const he=i(se,f,w);if(he>ce)z=se,ce=he}return z}function c(h,f,w){if("default"in h)return h.default;else{const z=t(h,f,w);return H(z,f,w)}}u.Create=c})(le||(le={})),e.Cast=H}),sr=ge((e)=>{var r=function(V){return pe.IsString(V)&&!isNaN(V)&&!isNaN(parseFloat(V))},s=function(V){return pe.IsBigInt(V)||pe.IsBoolean(V)||pe.IsNumber(V)},a=function(V){return V===!0||pe.IsNumber(V)&&V===1||pe.IsBigInt(V)&&V===BigInt("1")||pe.IsString(V)&&(V.toLowerCase()==="true"||V==="1")},T=function(V){return V===!1||pe.IsNumber(V)&&V===0||pe.IsBigInt(V)&&V===BigInt("0")||pe.IsString(V)&&(V.toLowerCase()==="false"||V==="0")},n=function(V){return pe.IsString(V)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(V)},E=function(V){return pe.IsString(V)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(V)},o=function(V){return pe.IsString(V)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(V)},C=function(V){return pe.IsString(V)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(V)},b=function(V){return pe.IsString(V)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(V)},P=function(V,ie){const m=U(V);return m===ie?m:V},G=function(V,ie){const m=A(V);return m===ie?m:V},x=function(V,ie){const m=N(V);return m===ie?m:V},F=function(V,ie){if(typeof V.const==="string")return P(ie,V.const);else if(typeof V.const==="number")return G(ie,V.const);else if(typeof V.const==="boolean")return x(ie,V.const);else return se.Clone(ie)},N=function(V){return a(V)?!0:T(V)?!1:V},O=function(V){return r(V)?BigInt(parseInt(V)):pe.IsNumber(V)?BigInt(V|0):T(V)?0:a(V)?1:V},U=function(V){return s(V)?V.toString():pe.IsSymbol(V)&&V.description!==void 0?V.description.toString():V},A=function(V){return r(V)?parseFloat(V):a(V)?1:T(V)?0:V},j=function(V){return r(V)?parseInt(V):pe.IsNumber(V)?V|0:a(V)?1:T(V)?0:V},I=function(V){return pe.IsString(V)&&V.toLowerCase()==="null"?null:V},W=function(V){return pe.IsString(V)&&V==="undefined"?void 0:V},B=function(V){return pe.IsDate(V)?V:pe.IsNumber(V)?new Date(V):a(V)?new Date(1):T(V)?new Date(0):r(V)?new Date(parseInt(V)):E(V)?new Date(`1970-01-01T${V}.000Z`):n(V)?new Date(`1970-01-01T${V}`):C(V)?new Date(`${V}.000Z`):o(V)?new Date(V):b(V)?new Date(`${V}T00:00:00.000Z`):V},ue=function(V,ie,m){return m},Ve=function(V,ie,m){if(pe.IsArray(m))return m.map((v)=>w(V.items,ie,v));return m},ae=function(V,ie,m){return m},Z=function(V,ie,m){return O(m)},de=function(V,ie,m){return N(m)},d=function(V,ie,m){return se.Clone(m)},g=function(V,ie,m){return B(m)},S=function(V,ie,m){return m},k=function(V,ie,m){return j(m)},K=function(V,ie,m){return m},R=function(V,ie,m){return m},H=function(V,ie,m){return F(V,m)},Q=function(V,ie,m){return m},X=function(V,ie,m){return I(m)},_=function(V,ie,m){return A(m)},Y=function(V,ie,m){if(pe.IsObject(m))return Object.getOwnPropertyNames(V.properties).reduce((v,D)=>{return m[D]!==void 0?{...v,[D]:w(V.properties[D],ie,m[D])}:{...v}},m);return m},ee=function(V,ie,m){return m},oe=function(V,ie,m){const v=Object.getOwnPropertyNames(V.patternProperties)[0],D=V.patternProperties[v],L={};for(let[fe,ne]of Object.entries(m))L[fe]=w(D,ie,ne);return L},M=function(V,ie,m){const v=ie.findIndex((L)=>L.$id===V.$ref);if(v===-1)throw new Se(V);const D=ie[v];return w(D,ie,m)},J=function(V,ie,m){return U(m)},re=function(V,ie,m){return m},te=function(V,ie,m){return m},q=function(V,ie,m){const v=ie.findIndex((L)=>L.$id===V.$ref);if(v===-1)throw new Se(V);const D=ie[v];return w(D,ie,m)},le=function(V,ie,m){if(pe.IsArray(m)&&!pe.IsUndefined(V.items))return m.map((v,D)=>{return D<V.items.length?w(V.items[D],ie,v):v});return m},u=function(V,ie,m){return W(m)},i=function(V,ie,m){for(let v of V.anyOf){const D=w(v,ie,m);if(he.Check(v,ie,D))return D}return m},t=function(V,ie,m){return m},c=function(V,ie,m){return m},h=function(V,ie,m){return m},f=function(V,ie,m){return m},w=function(V,ie,m){const v=pe.IsString(V.$id)?[...ie,V]:ie,D=V;switch(V[ce.Kind]){case"Any":return ue(D,v,m);case"Array":return Ve(D,v,m);case"AsyncIterator":return ae(D,v,m);case"BigInt":return Z(D,v,m);case"Boolean":return de(D,v,m);case"Constructor":return d(D,v,m);case"Date":return g(D,v,m);case"Function":return S(D,v,m);case"Integer":return k(D,v,m);case"Intersect":return K(D,v,m);case"Iterator":return R(D,v,m);case"Literal":return H(D,v,m);case"Never":return Q(D,v,m);case"Null":return X(D,v,m);case"Number":return _(D,v,m);case"Object":return Y(D,v,m);case"Promise":return ee(D,v,m);case"Record":return oe(D,v,m);case"Ref":return M(D,v,m);case"String":return J(D,v,m);case"Symbol":return re(D,v,m);case"TemplateLiteral":return te(D,v,m);case"This":return q(D,v,m);case"Tuple":return le(D,v,m);case"Undefined":return u(D,v,m);case"Union":return i(D,v,m);case"Uint8Array":return t(D,v,m);case"Unknown":return c(D,v,m);case"Void":return h(D,v,m);default:if(!ce.TypeRegistry.Has(D[ce.Kind]))throw new Re(D);return f(D,v,m)}},z=function(...V){return V.length===3?w(V[0],V[1],V[2]):w(V[0],[],V[1])};Object.defineProperty(e,"__esModule",{value:!0}),e.Convert=e.ValueConvertDereferenceError=e.ValueConvertUnknownTypeError=void 0;var ce=Pe(),se=tt(),he=ut(),pe=Ge();class Re extends Error{constructor(V){super("ValueConvert: Unknown type");this.schema=V}}e.ValueConvertUnknownTypeError=Re;class Se extends Error{constructor(V){super(`ValueConvert: Unable to dereference type with $id '${V.$ref}'`);this.schema=V}}e.ValueConvertDereferenceError=Se,e.Convert=z}),cr=ge((e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Value=void 0;var r=ct(),s=nr(),a=st(),T=ar(),n=ir(),E=tt(),o=sr(),C=Gt(),b=ut(),P=Ot(),G;(function(x){function F(...ae){return n.Cast.apply(n,ae)}x.Cast=F;function N(...ae){return C.Create.apply(C,ae)}x.Create=N;function O(...ae){return b.Check.apply(b,ae)}x.Check=O;function U(...ae){return o.Convert.apply(o,ae)}x.Convert=U;function A(ae){return E.Clone(ae)}x.Clone=A;function j(...ae){return r.Errors.apply(r,ae)}x.Errors=j;function I(ae,Z){return T.Equal(ae,Z)}x.Equal=I;function W(ae,Z){return P.Diff(ae,Z)}x.Diff=W;function B(ae){return a.Hash(ae)}x.Hash=B;function ue(ae,Z){return P.Patch(ae,Z)}x.Patch=ue;function Ve(ae,Z){s.Mutate(ae,Z)}x.Mutate=Ve})(G||(e.Value=G={}))}),_t=ge((e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Value=e.ValuePointer=e.Delete=e.Update=e.Insert=e.Edit=e.ValueErrorIterator=e.ValueErrorType=void 0;var r=ct();Object.defineProperty(e,"ValueErrorType",{enumerable:!0,get:function(){return r.ValueErrorType}}),Object.defineProperty(e,"ValueErrorIterator",{enumerable:!0,get:function(){return r.ValueErrorIterator}});var s=Ot();Object.defineProperty(e,"Edit",{enumerable:!0,get:function(){return s.Edit}}),Object.defineProperty(e,"Insert",{enumerable:!0,get:function(){return s.Insert}}),Object.defineProperty(e,"Update",{enumerable:!0,get:function(){return s.Update}}),Object.defineProperty(e,"Delete",{enumerable:!0,get:function(){return s.Delete}});var a=Tt();Object.defineProperty(e,"ValuePointer",{enumerable:!0,get:function(){return a.ValuePointer}});var T=cr();Object.defineProperty(e,"Value",{enumerable:!0,get:function(){return T.Value}})}),ur=ge((e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TypeCompiler=e.TypeCompilerTypeGuardError=e.TypeCompilerDereferenceError=e.TypeCompilerUnknownTypeError=e.TypeCheck=void 0;var r=it(),s=Pe(),a=ct(),T=st(),n=Ge();class E{constructor(N,O,U,A){this.schema=N,this.references=O,this.checkFunc=U,this.code=A}Code(){return this.code}Errors(N){return a.Errors(this.schema,this.references,N)}Check(N){return this.checkFunc(N)}}e.TypeCheck=E;var o;(function(N){function O(I){return I===36}N.DollarSign=O;function U(I){return I===95}N.IsUnderscore=U;function A(I){return I>=65&&I<=90||I>=97&&I<=122}N.IsAlpha=A;function j(I){return I>=48&&I<=57}N.IsNumeric=j})(o||(o={}));var C;(function(N){function O(I){if(I.length===0)return!1;return o.IsNumeric(I.charCodeAt(0))}function U(I){if(O(I))return!1;for(let W=0;W<I.length;W++){const B=I.charCodeAt(W);if(!(o.IsAlpha(B)||o.IsNumeric(B)||o.DollarSign(B)||o.IsUnderscore(B)))return!1}return!0}function A(I){return I.replace(/'/g,"\\'")}function j(I,W){return U(W)?`${I}.${W}`:`${I}['${A(W)}']`}N.Encode=j})(C||(C={}));var b;(function(N){function O(U){const A=[];for(let j=0;j<U.length;j++){const I=U.charCodeAt(j);if(o.IsNumeric(I)||o.IsAlpha(I))A.push(U.charAt(j));else A.push(`_${I}_`)}return A.join("").replace(/__/g,"_")}N.Encode=O})(b||(b={}));class P extends Error{constructor(N){super("TypeCompiler: Unknown type");this.schema=N}}e.TypeCompilerUnknownTypeError=P;class G extends Error{constructor(N){super(`TypeCompiler: Unable to dereference type with $id '${N.$ref}'`);this.schema=N}}e.TypeCompilerDereferenceError=G;class x extends Error{constructor(N){super("TypeCompiler: Preflight validation check failed to guard for the given schema");this.schema=N}}e.TypeCompilerTypeGuardError=x;var F;(function(N){function O(v){return v[s.Kind]==="Any"||v[s.Kind]==="Unknown"}function U(v,D,L){return r.TypeSystem.ExactOptionalPropertyTypes?`('${D}' in ${v} ? ${L} : true)`:`(${C.Encode(v,D)} !== undefined ? ${L} : true)`}function A(v){return!r.TypeSystem.AllowArrayObjects?`(typeof ${v} === 'object' && ${v} !== null && !Array.isArray(${v}))`:`(typeof ${v} === 'object' && ${v} !== null)`}function j(v){return!r.TypeSystem.AllowArrayObjects?`(typeof ${v} === 'object' && ${v} !== null && !Array.isArray(${v}) && !(${v} instanceof Date) && !(${v} instanceof Uint8Array))`:`(typeof ${v} === 'object' && ${v} !== null && !(${v} instanceof Date) && !(${v} instanceof Uint8Array))`}function I(v){return!r.TypeSystem.AllowNaN?`(typeof ${v} === 'number' && Number.isFinite(${v}))`:`typeof ${v} === 'number'`}function W(v){return r.TypeSystem.AllowVoidNull?`(${v} === undefined || ${v} === null)`:`${v} === undefined`}function*B(v,D,L){yield"true"}function*ue(v,D,L){yield`Array.isArray(${L})`;const[fe,ne]=[Re("value","any"),Re("acc","number")];if(n.IsNumber(v.minItems))yield`${L}.length >= ${v.minItems}`;if(n.IsNumber(v.maxItems))yield`${L}.length <= ${v.maxItems}`;const $=ce(v.items,D,"value");if(yield`${L}.every((${fe}) => ${$})`,s.TypeGuard.TSchema(v.contains)||n.IsNumber(v.minContains)||n.IsNumber(v.maxContains)){const ve=s.TypeGuard.TSchema(v.contains)?v.contains:s.Type.Never(),Ee=ce(ve,D,"value"),ke=n.IsNumber(v.minContains)?[`(count >= ${v.minContains})`]:[],Le=n.IsNumber(v.maxContains)?[`(count <= ${v.maxContains})`]:[],xe=`const count = ${L}.reduce((${ne}, ${fe}) => ${Ee} ? acc + 1 : acc, 0)`,Ne=["(count > 0)",...ke,...Le].join(" && ");yield`((${fe}) => { ${xe}; return ${Ne}})(${L})`}if(v.uniqueItems===!0)yield`((${fe}) => { const set = new Set(); for(const element of value) { const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true } )(${L})`}function*Ve(v,D,L){yield`(typeof value === 'object' && Symbol.asyncIterator in ${L})`}function*ae(v,D,L){if(yield`(typeof ${L} === 'bigint')`,n.IsBigInt(v.multipleOf))yield`(${L} % BigInt(${v.multipleOf})) === 0`;if(n.IsBigInt(v.exclusiveMinimum))yield`${L} > BigInt(${v.exclusiveMinimum})`;if(n.IsBigInt(v.exclusiveMaximum))yield`${L} < BigInt(${v.exclusiveMaximum})`;if(n.IsBigInt(v.minimum))yield`${L} >= BigInt(${v.minimum})`;if(n.IsBigInt(v.maximum))yield`${L} <= BigInt(${v.maximum})`}function*Z(v,D,L){yield`(typeof ${L} === 'boolean')`}function*de(v,D,L){yield*w(v.returns,D,`${L}.prototype`)}function*d(v,D,L){if(yield`(${L} instanceof Date) && Number.isFinite(${L}.getTime())`,n.IsNumber(v.exclusiveMinimumTimestamp))yield`${L}.getTime() > ${v.exclusiveMinimumTimestamp}`;if(n.IsNumber(v.exclusiveMaximumTimestamp))yield`${L}.getTime() < ${v.exclusiveMaximumTimestamp}`;if(n.IsNumber(v.minimumTimestamp))yield`${L}.getTime() >= ${v.minimumTimestamp}`;if(n.IsNumber(v.maximumTimestamp))yield`${L}.getTime() <= ${v.maximumTimestamp}`}function*g(v,D,L){yield`(typeof ${L} === 'function')`}function*S(v,D,L){if(yield`(typeof ${L} === 'number' && Number.isInteger(${L}))`,n.IsNumber(v.multipleOf))yield`(${L} % ${v.multipleOf}) === 0`;if(n.IsNumber(v.exclusiveMinimum))yield`${L} > ${v.exclusiveMinimum}`;if(n.IsNumber(v.exclusiveMaximum))yield`${L} < ${v.exclusiveMaximum}`;if(n.IsNumber(v.minimum))yield`${L} >= ${v.minimum}`;if(n.IsNumber(v.maximum))yield`${L} <= ${v.maximum}`}function*k(v,D,L){const fe=v.allOf.map((ne)=>ce(ne,D,L)).join(" && ");if(v.unevaluatedProperties===!1){const ne=he(`${new RegExp(s.KeyResolver.ResolvePattern(v))};`),$=`Object.getOwnPropertyNames(${L}).every(key => ${ne}.test(key))`;yield`(${fe} && ${$})`}else if(s.TypeGuard.TSchema(v.unevaluatedProperties)){const ne=he(`${new RegExp(s.KeyResolver.ResolvePattern(v))};`),$=`Object.getOwnPropertyNames(${L}).every(key => ${ne}.test(key) || ${ce(v.unevaluatedProperties,D,`${L}[key]`)})`;yield`(${fe} && ${$})`}else yield`(${fe})`}function*K(v,D,L){yield`(typeof value === 'object' && Symbol.iterator in ${L})`}function*R(v,D,L){if(typeof v.const==="number"||typeof v.const==="boolean")yield`(${L} === ${v.const})`;else yield`(${L} === '${v.const}')`}function*H(v,D,L){yield"false"}function*Q(v,D,L){yield`(!${ce(v.not,D,L)})`}function*X(v,D,L){yield`(${L} === null)`}function*_(v,D,L){if(yield I(L),n.IsNumber(v.multipleOf))yield`(${L} % ${v.multipleOf}) === 0`;if(n.IsNumber(v.exclusiveMinimum))yield`${L} > ${v.exclusiveMinimum}`;if(n.IsNumber(v.exclusiveMaximum))yield`${L} < ${v.exclusiveMaximum}`;if(n.IsNumber(v.minimum))yield`${L} >= ${v.minimum}`;if(n.IsNumber(v.maximum))yield`${L} <= ${v.maximum}`}function*Y(v,D,L){if(yield A(L),n.IsNumber(v.minProperties))yield`Object.getOwnPropertyNames(${L}).length >= ${v.minProperties}`;if(n.IsNumber(v.maxProperties))yield`Object.getOwnPropertyNames(${L}).length <= ${v.maxProperties}`;const fe=Object.getOwnPropertyNames(v.properties);for(let ne of fe){const $=C.Encode(L,ne),ve=v.properties[ne];if(v.required&&v.required.includes(ne)){if(yield*w(ve,D,$),s.ExtendsUndefined.Check(ve)||O(ve))yield`('${ne}' in ${L})`}else{const Ee=ce(ve,D,$);yield U(L,ne,Ee)}}if(v.additionalProperties===!1)if(v.required&&v.required.length===fe.length)yield`Object.getOwnPropertyNames(${L}).length === ${fe.length}`;else{const ne=`[${fe.map(($)=>`'${$}'`).join(", ")}]`;yield`Object.getOwnPropertyNames(${L}).every(key => ${ne}.includes(key))`}if(typeof v.additionalProperties==="object"){const ne=ce(v.additionalProperties,D,`${L}[key]`),$=`[${fe.map((ve)=>`'${ve}'`).join(", ")}]`;yield`(Object.getOwnPropertyNames(${L}).every(key => ${$}.includes(key) || ${ne}))`}}function*ee(v,D,L){yield`(typeof value === 'object' && typeof ${L}.then === 'function')`}function*oe(v,D,L){if(yield j(L),n.IsNumber(v.minProperties))yield`Object.getOwnPropertyNames(${L}).length >= ${v.minProperties}`;if(n.IsNumber(v.maxProperties))yield`Object.getOwnPropertyNames(${L}).length <= ${v.maxProperties}`;const[fe,ne]=Object.entries(v.patternProperties)[0],$=he(`new RegExp(/${fe}/)`),ve=ce(ne,D,"value"),Ee=s.TypeGuard.TSchema(v.additionalProperties)?ce(v.additionalProperties,D,L):v.additionalProperties===!1?"false":"true",ke=`(${$}.test(key) ? ${ve} : ${Ee})`;yield`(Object.entries(${L}).every(([key, value]) => ${ke}))`}function*M(v,D,L){const fe=D.findIndex(($)=>$.$id===v.$ref);if(fe===-1)throw new G(v);const ne=D[fe];if(z.functions.has(v.$ref))return yield`${se(v.$ref)}(${L})`;yield*w(ne,D,L)}function*J(v,D,L){if(yield`(typeof ${L} === 'string')`,n.IsNumber(v.minLength))yield`${L}.length >= ${v.minLength}`;if(n.IsNumber(v.maxLength))yield`${L}.length <= ${v.maxLength}`;if(v.pattern!==void 0)yield`${he(`${new RegExp(v.pattern)};`)}.test(${L})`;if(v.format!==void 0)yield`format('${v.format}', ${L})`}function*re(v,D,L){yield`(typeof ${L} === 'symbol')`}function*te(v,D,L){yield`(typeof ${L} === 'string')`,yield`${he(`${new RegExp(v.pattern)};`)}.test(${L})`}function*q(v,D,L){yield`${se(v.$ref)}(${L})`}function*le(v,D,L){if(yield`Array.isArray(${L})`,v.items===void 0)return yield`${L}.length === 0`;yield`(${L}.length === ${v.maxItems})`;for(let fe=0;fe<v.items.length;fe++)yield`${ce(v.items[fe],D,`${L}[${fe}]`)}`}function*u(v,D,L){yield`${L} === undefined`}function*i(v,D,L){yield`(${v.anyOf.map((fe)=>ce(fe,D,L)).join(" || ")})`}function*t(v,D,L){if(yield`${L} instanceof Uint8Array`,n.IsNumber(v.maxByteLength))yield`(${L}.length <= ${v.maxByteLength})`;if(n.IsNumber(v.minByteLength))yield`(${L}.length >= ${v.minByteLength})`}function*c(v,D,L){yield"true"}function*h(v,D,L){yield W(L)}function*f(v,D,L){const fe=z.instances.size;z.instances.set(fe,v),yield`kind('${v[s.Kind]}', ${fe}, ${L})`}function*w(v,D,L,fe=!0){const ne=n.IsString(v.$id)?[...D,v]:D,$=v;if(fe&&n.IsString(v.$id)){const ve=se(v.$id);if(z.functions.has(ve))return yield`${ve}(${L})`;else{const Ee=pe(ve,v,D,"value",!1);return z.functions.set(ve,Ee),yield`${ve}(${L})`}}switch($[s.Kind]){case"Any":return yield*B($,ne,L);case"Array":return yield*ue($,ne,L);case"AsyncIterator":return yield*Ve($,ne,L);case"BigInt":return yield*ae($,ne,L);case"Boolean":return yield*Z($,ne,L);case"Constructor":return yield*de($,ne,L);case"Date":return yield*d($,ne,L);case"Function":return yield*g($,ne,L);case"Integer":return yield*S($,ne,L);case"Intersect":return yield*k($,ne,L);case"Iterator":return yield*K($,ne,L);case"Literal":return yield*R($,ne,L);case"Never":return yield*H($,ne,L);case"Not":return yield*Q($,ne,L);case"Null":return yield*X($,ne,L);case"Number":return yield*_($,ne,L);case"Object":return yield*Y($,ne,L);case"Promise":return yield*ee($,ne,L);case"Record":return yield*oe($,ne,L);case"Ref":return yield*M($,ne,L);case"String":return yield*J($,ne,L);case"Symbol":return yield*re($,ne,L);case"TemplateLiteral":return yield*te($,ne,L);case"This":return yield*q($,ne,L);case"Tuple":return yield*le($,ne,L);case"Undefined":return yield*u($,ne,L);case"Union":return yield*i($,ne,L);case"Uint8Array":return yield*t($,ne,L);case"Unknown":return yield*c($,ne,L);case"Void":return yield*h($,ne,L);default:if(!s.TypeRegistry.Has($[s.Kind]))throw new P(v);return yield*f($,ne,L)}}const z={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function ce(v,D,L,fe=!0){return`(${[...w(v,D,L,fe)].join(" && ")})`}function se(v){return`check_${b.Encode(v)}`}function he(v){const D=`local_${z.variables.size}`;return z.variables.set(D,`const ${D} = ${v}`),D}function pe(v,D,L,fe,ne=!0){const[$,ve]=["\n",(xe)=>"".padStart(xe," ")],Ee=Re("value","any"),ke=Se("boolean"),Le=[...w(D,L,fe,ne)].map((xe)=>`${ve(4)}${xe}`).join(` &&${$}`);return`function ${v}(${Ee})${ke} {${$}${ve(2)}return (${$}${Le}${$}${ve(2)})\n}`}function Re(v,D){const L=z.language==="typescript"?`: ${D}`:"";return`${v}${L}`}function Se(v){return z.language==="typescript"?`: ${v}`:""}function V(v,D,L){const fe=pe("check",v,D,"value"),ne=Re("value","any"),$=Se("boolean"),ve=[...z.functions.values()],Ee=[...z.variables.values()],ke=n.IsString(v.$id)?`return function check(${ne})${$} {\n  return ${se(v.$id)}(value)\n}`:`return ${fe}`;return[...Ee,...ve,ke].join("\n")}function ie(...v){const D={language:"javascript"},[L,fe,ne]=v.length===2&&n.IsArray(v[1])?[v[0],v[1],D]:v.length===2&&!n.IsArray(v[1])?[v[0],[],v[1]]:v.length===3?[v[0],v[1],v[2]]:v.length===1?[v[0],[],D]:[null,[],D];if(z.language=ne.language,z.variables.clear(),z.functions.clear(),z.instances.clear(),!s.TypeGuard.TSchema(L))throw new x(L);for(let $ of fe)if(!s.TypeGuard.TSchema($))throw new x($);return V(L,fe,ne)}N.Code=ie;function m(v,D=[]){const L=ie(v,D,{language:"javascript"}),fe=globalThis.Function("kind","format","hash",L),ne=new Map(z.instances);function $(Le,xe,Ne){if(!s.TypeRegistry.Has(Le)||!ne.has(xe))return!1;const qe=ne.get(xe);return s.TypeRegistry.Get(Le)(qe,Ne)}function ve(Le,xe){if(!s.FormatRegistry.Has(Le))return!1;return s.FormatRegistry.Get(Le)(xe)}function Ee(Le){return T.Hash(Le)}const ke=fe($,ve,Ee);return new E(v,D,ke,L)}N.Compile=m})(F||(e.TypeCompiler=F={}))}),or=ge((e)=>{var r=e&&e.__createBinding||(Object.create?function(T,n,E,o){if(o===void 0)o=E;var C=Object.getOwnPropertyDescriptor(n,E);if(!C||("get"in C?!n.__esModule:C.writable||C.configurable))C={enumerable:!0,get:function(){return n[E]}};Object.defineProperty(T,o,C)}:function(T,n,E,o){if(o===void 0)o=E;T[o]=n[E]}),s=e&&e.__exportStar||function(T,n){for(var E in T)if(E!=="default"&&!Object.prototype.hasOwnProperty.call(n,E))r(n,T,E)};Object.defineProperty(e,"__esModule",{value:!0}),e.ValueErrorType=void 0;var a=ct();Object.defineProperty(e,"ValueErrorType",{enumerable:!0,get:function(){return a.ValueErrorType}}),s(ur(),e)}),fr=ge((e,r)=>{var s=function(C){var b=C.indexOf("%");if(b===-1)return C;var P=C.length,G="",x=0,F=0,N=b,O=T;while(b>-1&&b<P){var U=a(C[b+1],4),A=a(C[b+2],0),j=U|A,I=E[j];if(O=E[256+O+I],F=F<<6|j&E[364+I],O===T)G+=C.slice(x,N),G+=F<=65535?String.fromCharCode(F):String.fromCharCode(55232+(F>>10),56320+(F&1023)),F=0,x=b+3,b=N=C.indexOf("%",x);else if(O===n)return null;else{if(b+=3,b<P&&C.charCodeAt(b)===37)continue;return null}}return G+C.slice(x)},a=function(C,b){var P=o[C];return P===void 0?255:P<<b},T=12,n=0,E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0,127,63,63,63,0,31,15,15,15,7,7,7],o={"0":0,"1":1,"2":2,"3":3,"4":4,"5":5,"6":6,"7":7,"8":8,"9":9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};r.exports=s}),lr=ge((e,r)=>{var s=function(E){const o=new n;if(typeof E!=="string")return o;let C=E.length,b="",P="",G=-1,x=-1,F=!1,N=!1,O=!1,U=!1,A=!1,j=0;for(let I=0;I<C+1;I++)if(j=I!==C?E.charCodeAt(I):38,j===38){if(A=x>G,!A)x=I;if(b=E.slice(G+1,x),A||b.length>0){if(O)b=b.replace(T," ");if(F)b=a(b)||b;if(A){if(P=E.slice(x+1,I),U)P=P.replace(T," ");if(N)P=a(P)||P}const W=o[b];if(W===void 0)o[b]=P;else if(W.pop)W.push(P);else o[b]=[W,P]}P="",G=I,x=I,F=!1,N=!1,O=!1,U=!1}else if(j===61)if(x<=G)x=I;else N=!0;else if(j===43)if(x>G)U=!0;else O=!0;else if(j===37)if(x>G)N=!0;else F=!0;return o},a=fr(),T=/\+/g,n=function(){};n.prototype=Object.create(null),r.exports=s}),pr=ge((e,r)=>{var s=function(n){const E=n.length;if(E===0)return"";let o="",C=0,b=0;e:for(;b<E;b++){let P=n.charCodeAt(b);while(P<128){if(T[P]!==1){if(C<b)o+=n.slice(C,b);C=b+1,o+=a[P]}if(++b===E)break e;P=n.charCodeAt(b)}if(C<b)o+=n.slice(C,b);if(P<2048){C=b+1,o+=a[192|P>>6]+a[128|P&63];continue}if(P<55296||P>=57344){C=b+1,o+=a[224|P>>12]+a[128|P>>6&63]+a[128|P&63];continue}if(++b,b>=E)throw new Error("URI malformed");const G=n.charCodeAt(b)&1023;C=b+1,P=65536+((P&1023)<<10|G),o+=a[240|P>>18]+a[128|P>>12&63]+a[128|P>>6&63]+a[128|P&63]}if(C===0)return n;if(C<E)return o+n.slice(C);return o},a=Array.from({length:256},(n,E)=>"%"+((E<16?"0":"")+E.toString(16)).toUpperCase()),T=new Int8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0]);r.exports={encodeString:s}}),dr=ge((e,r)=>{var s=function(n){const E=typeof n;if(E==="string")return T(n);else if(E==="bigint")return n.toString();else if(E==="boolean")return n?"true":"false";else if(E==="number"&&Number.isFinite(n))return n<1000000000000000000000?""+n:T(""+n);return""},a=function(n){let E="";if(n===null||typeof n!=="object")return E;const o="&",C=Object.keys(n),b=C.length;let P=0;for(let G=0;G<b;G++){const x=C[G],F=n[x],N=T(x)+"=";if(G)E+=o;if(Array.isArray(F)){P=F.length;for(let O=0;O<P;O++){if(O)E+=o;E+=N,E+=s(F[O])}}else E+=N,E+=s(F)}return E},{encodeString:T}=pr();r.exports=a}),Kt=ge((e,r)=>{var s=lr(),a=dr(),T={parse:s,stringify:a};r.exports=T,r.exports.default=T,r.exports.parse=s,r.exports.stringify=a}),Ue=(e,r)=>({part:e,store:null,inert:r!==void 0?new Map(r.map((s)=>[s.part.charCodeAt(0),s])):null,params:null,wildcardStore:null}),gt=(e,r)=>({...e,part:r}),Vt=(e)=>({paramName:e,store:null,inert:null});class Qe{root={};history=[];static regex={static:/:.+?(?=\/|$)/,params:/:.+?(?=\/|$)/g};add(e,r,s){let a;if(typeof r!="string")throw TypeError("Route path must be a string");r===""?r="/":r[0]!=="/"&&(r=`/${r}`),this.history.push([e,r,s]);let T=r[r.length-1]==="*";T&&(r=r.slice(0,-1));let n=r.split(Qe.regex.static),E=r.match(Qe.regex.params)||[];n[n.length-1]===""&&n.pop(),a=this.root[e]?this.root[e]:this.root[e]=Ue("/");let o=0;for(let C=0;C<n.length;++C){let b=n[C];if(C>0){let P=E[o++].slice(1);if(a.params===null)a.params=Vt(P);else if(a.params.paramName!==P)throw Error(`Cannot create route "${r}" with parameter "${P}" because a route already exists with a different parameter name ("${a.params.paramName}") in the same location`);let G=a.params;if(G.inert===null){a=G.inert=Ue(b);continue}a=G.inert}for(let P=0;;){if(P===b.length){if(P<a.part.length){let G=gt(a,a.part.slice(P));Object.assign(a,Ue(b,[G]))}break}if(P===a.part.length){if(a.inert===null)a.inert=new Map;else if(a.inert.has(b.charCodeAt(P))){a=a.inert.get(b.charCodeAt(P)),b=b.slice(P),P=0;continue}let G=Ue(b.slice(P));a.inert.set(b.charCodeAt(P),G),a=G;break}if(b[P]!==a.part[P]){let G=gt(a,a.part.slice(P)),x=Ue(b.slice(P));Object.assign(a,Ue(a.part.slice(0,P),[G,x])),a=x;break}++P}}if(o<E.length){let C=E[o],b=C.slice(1);if(a.params===null)a.params=Vt(b);else if(a.params.paramName!==b)throw Error(`Cannot create route "${r}" with parameter "${b}" because a route already exists with a different parameter name ("${a.params.paramName}") in the same location`);return a.params.store===null&&(a.params.store=s),a.params.store}return T?(a.wildcardStore===null&&(a.wildcardStore=s),a.wildcardStore):(a.store===null&&(a.store=s),a.store)}find(e,r){let s=this.root[e];return s?vt(r,r.length,s,0):null}}var vt=(e,r,s,a)=>{let T=s?.part,n=a+T.length;if(T.length>1){if(n>r)return null;if(T.length<15){for(let E=1,o=a+1;E<T.length;++E,++o)if(T.charCodeAt(E)!==e.charCodeAt(o))return null}else if(e.substring(a,n)!==T)return null}if(n===r)return s.store!==null?{store:s.store,params:{}}:s.wildcardStore!==null?{store:s.wildcardStore,params:{"*":""}}:null;if(s.inert!==null){let E=s.inert.get(e.charCodeAt(n));if(E!==void 0){let o=vt(e,r,E,n);if(o!==null)return o}}if(s.params!==null){let E=s.params,o=e.indexOf("/",n);if(o!==n){if(o===-1||o>=r){if(E.store!==null){let C={};return C[E.paramName]=e.substring(n,r),{store:E.store,params:C}}}else if(E.inert!==null){let C=vt(e,r,E.inert,o);if(C!==null)return C.params[E.paramName]=e.substring(n,o),C}}}return s.wildcardStore!==null?{store:s.wildcardStore,params:{"*":e.substring(n,r)}}:null},pt=Be(Pe(),1),nt=Be(_t(),1),Pt=Be(or(),1),je=(e,r)=>{const s=[...Array.isArray(e)?e:[e]],a=[];for(let T of s)if(T.$elysiaChecksum)a.push(T.$elysiaChecksum);for(let T of Array.isArray(r)?r:[r])if(!a.includes(T?.$elysiaChecksum))s.push(T);return s},Ze=(e,r)=>{return{body:r?.body??e?.body,headers:r?.headers??e?.headers,params:r?.params??e?.params,query:r?.query??e?.query,response:r?.response??e?.response,type:e?.type||r?.type,detail:De(r?.detail??{},e?.detail??{}),parse:je(e.parse??[],r?.parse??[]),transform:je(e.transform??[],r?.transform??[]),beforeHandle:je(e.beforeHandle??[],r?.beforeHandle??[]),afterHandle:je(e.afterHandle??[],r?.afterHandle??[]),onResponse:je(e.onResponse??[],r?.onResponse??[]),error:je(e.error??[],r?.error??[])}},dt=(e)=>e&&typeof e==="object"&&!Array.isArray(e),De=(e,r)=>{const s=Object.assign({},e);if(dt(e)&&dt(r))Object.keys(r).forEach((a)=>{if(dt(r[a]))if(!(a in e))Object.assign(s,{[a]:r[a]});else s[a]=De(e[a],r[a]);else Object.assign(s,{[a]:r[a]})});return s},_e=(e,{models:r={},additionalProperties:s=!1,dynamic:a=!1})=>{if(!e)return;if(typeof e==="string"&&!(e in r))return;const T=typeof e==="string"?r[e]:e;if(T.type==="object"&&("additionalProperties"in T)===!1)T.additionalProperties=s;if(a)return{schema:T,references:"",checkFunc:()=>{},code:"",Check:(n)=>nt.Value.Check(T,n),Errors:(n)=>nt.Value.Errors(T,n),Code:()=>""};return Pt.TypeCompiler.Compile(T)},hr=(e,{models:r={},additionalProperties:s=!1,dynamic:a=!1})=>{if(!e)return;if(typeof e==="string"&&!(e in r))return;const T=typeof e==="string"?r[e]:e,n=(o)=>{if(a)return{schema:o,references:"",checkFunc:()=>{},code:"",Check:(C)=>nt.Value.Check(o,C),Errors:(C)=>nt.Value.Errors(o,C),Code:()=>""};return Pt.TypeCompiler.Compile(o)};if(pt.Kind in T)return{200:n(T)};const E={};return Object.keys(T).forEach((o)=>{const C=T[o];if(typeof C==="string"){if(C in r){const b=r[C];b.type==="object"&&("additionalProperties"in b),E[+o]=(pt.Kind in b)?n(b):b}return}if(C.type==="object"&&("additionalProperties"in C)===!1)C.additionalProperties=s;E[+o]=(pt.Kind in C)?n(C):C}),E},yr=(e)=>{let r=9;for(let s=0;s<e.length;)r=Math.imul(r^e.charCodeAt(s++),387420489);return r=r^r>>>9},ht=(e,r,s)=>{const a=(T)=>{if(s)T.$elysiaChecksum=s;return T};return{start:je(e.start,("start"in r?r.start:[]).map(a)),request:je(e.request,("request"in r?r.request:[]).map(a)),parse:je(e.parse,r?.parse??[]).map(a),transform:je(e.transform,(r?.transform??[]).map(a)),beforeHandle:je(e.beforeHandle,(r?.beforeHandle??[]).map(a)),afterHandle:je(e.afterHandle,(r?.afterHandle??[]).map(a)),onResponse:je(e.onResponse,(r?.onResponse??[]).map(a)),error:je(e.error,(r?.error??[]).map(a)),stop:je(e.stop,("stop"in r?r.stop:[]).map(a))}},vr=(e,r=!0)=>{if(!e)return e;if(typeof e==="function"){if(r)e.$elysiaHookType="global";else e.$elysiaHookType=void 0;return e}return e.map((s)=>{if(r)s.$elysiaHookType="global";else s.$elysiaHookType=void 0;return s})},me=(e)=>{if(!e)return e;if(typeof e==="function")return e.$elysiaHookType==="global"?e:void 0;return e.filter((r)=>r.$elysiaHookType==="global")},Rt=(e)=>{return{...e,type:e?.type,detail:e?.detail,parse:me(e?.parse),transform:me(e?.transform),beforeHandle:me(e?.beforeHandle),afterHandle:me(e?.afterHandle),onResponse:me(e?.onResponse),error:me(e?.error)}},Tr=Be(Kt(),1),Nt="toJSON"in new Headers,wt=(e)=>{for(let r in e)return!0;return!1},Bt=(e,r)=>{e.delete("Set-Cookie");for(let s=0;s<r.length;s++){const a=r[s].indexOf("=");e.append("Set-Cookie",`${r[s].slice(0,a)}=${r[s].slice(a+1)}`)}return e},Fe=(e,r)=>{if(wt(r.headers)||r.status!==200||r.redirect){if(r.redirect)r.headers.Location=r.redirect,r.status=302;if(r.headers["Set-Cookie"]&&Array.isArray(r.headers["Set-Cookie"]))r.headers=Bt(new Headers(r.headers),r.headers["Set-Cookie"]);switch(e?.constructor?.name){case"String":case"Blob":return new Response(e,r);case"Object":case"Array":return Response.json(e,r);case void 0:if(!e)return;return Response.json(e,r);case"Response":const s={...r.headers};if(Nt)r.headers=e.headers.toJSON();else for(let[T,n]of e.headers.entries())if(!(T in r.headers))r.headers[T]=n;for(let T in s)e.headers.append(T,s[T]);if(e.status!==r.status)r.status=e.status;return e;case"Promise":return e.then((T)=>{const n=Fe(T,r);if(n!==void 0)return n;return});case"Error":return Je(e,r.headers);case"Function":return e();case"Number":case"Boolean":return new Response(e.toString(),r);default:if(e instanceof Response)return e;const a=JSON.stringify(e);if(a.charCodeAt(0)===123){if(!r.headers["Content-Type"])r.headers["Content-Type"]="application/json";return new Response(JSON.stringify(e),r)}return new Response(a,r)}}else switch(e?.constructor?.name){case"String":case"Blob":return new Response(e);case"Object":case"Array":return new Response(JSON.stringify(e),{headers:{"content-type":"application/json"}});case void 0:if(!e)return new Response("");return new Response(JSON.stringify(e),{headers:{"content-type":"application/json"}});case"Response":return e;case"Promise":return e.then((a)=>{const T=Fe(a,r);if(T!==void 0)return T;return});case"Error":return Je(e,r.headers);case"Function":return e();case"Number":case"Boolean":return new Response(e.toString());default:if(e instanceof Response)return e;const s=JSON.stringify(e);if(s.charCodeAt(0)===123)return new Response(JSON.stringify(e),{headers:{"Content-Type":"application/json"}});return new Response(s)}},ze=(e,r)=>{if(wt(r.headers)||r.status!==200||r.redirect){if(r.redirect)r.headers.Location=r.redirect,r.status=302;if(r.headers["Set-Cookie"]&&Array.isArray(r.headers["Set-Cookie"]))r.headers=Bt(new Headers(r.headers),r.headers["Set-Cookie"]);switch(e?.constructor?.name){case"String":case"Blob":return new Response(e,{status:r.status,headers:r.headers});case"Object":case"Array":return Response.json(e,r);case void 0:if(!e)return new Response("",r);return Response.json(e,r);case"Response":const s={...r.headers};if(Nt)r.headers=e.headers.toJSON();else for(let[T,n]of e.headers.entries())if(!(T in r.headers))r.headers[T]=n;for(let T in s)e.headers.append(T,s[T]);return e;case"Error":return Je(e,r.headers);case"Promise":return e.then((T)=>ze(T,r));case"Function":return e();case"Number":case"Boolean":return new Response(e.toString(),r);default:if(e instanceof Response)return e;const a=JSON.stringify(e);if(a.charCodeAt(0)===123){if(!r.headers["Content-Type"])r.headers["Content-Type"]="application/json";return new Response(JSON.stringify(e),r)}return new Response(a,r)}}else switch(e?.constructor?.name){case"String":case"Blob":return new Response(e);case"Object":case"Array":return new Response(JSON.stringify(e),{headers:{"content-type":"application/json"}});case void 0:if(!e)return new Response("");return new Response(JSON.stringify(e),{headers:{"content-type":"application/json"}});case"Response":return e;case"Error":return Je(e);case"Promise":return e.then((a)=>{const T=ze(a,r);if(T!==void 0)return T;return new Response("")});case"Function":return e();case"Number":case"Boolean":return new Response(e.toString());default:if(e instanceof Response)return e;const s=JSON.stringify(e);if(s.charCodeAt(0)===123)return new Response(JSON.stringify(e),{headers:{"Content-Type":"application/json"}});return new Response(s)}},Dt=(e)=>{switch(e?.constructor?.name){case"String":case"Blob":return new Response(e);case"Object":case"Array":return new Response(JSON.stringify(e),{headers:{"content-type":"application/json"}});case void 0:if(!e)return new Response("");return new Response(JSON.stringify(e),{headers:{"content-type":"application/json"}});case"Response":return e;case"Error":return Je(e);case"Promise":return e.then((s)=>{const a=Dt(s);if(a!==void 0)return a;return new Response("")});case"Function":return e();case"Number":case"Boolean":return new Response(e.toString());default:if(e instanceof Response)return e;const r=JSON.stringify(e);if(r.charCodeAt(0)===123)return new Response(JSON.stringify(e),{headers:{"Content-Type":"application/json"}});return new Response(r)}},Je=(e,r)=>new Response(JSON.stringify({name:e?.name,message:e?.message,cause:e?.cause}),{status:500,headers:r}),Et=Be(_t(),1),Ct=typeof Bun!=="undefined"?Bun.env:typeof process!=="undefined"?process?.env:void 0,$e=Symbol("ErrorCode"),at=(Ct?.NODE_ENV??Ct?.ENV)==="production";class At extends Error{code="NOT_FOUND";status=500;constructor(){super("INTERNAL_SERVER_ERROR")}}class ot extends Error{code="NOT_FOUND";status=404;constructor(){super("NOT_FOUND")}}class Ke extends Error{$;Y;J;code="VALIDATION";status=400;constructor(e,r,s){const a=at?void 0:r.Errors(s).First(),T=a?.schema.error?typeof a.schema.error==="function"?a.schema.error(e,r,s):a.schema.error:void 0,n=at?T??`Invalid ${e??a?.schema.error??a?.message}`:T??`Invalid ${e}, '${a?.path?.slice(1)||"type"}': ${a?.message}`+"\n\nExpected: "+JSON.stringify(Et.Value.Create(r.schema),null,2)+"\n\nFound: "+JSON.stringify(s,null,2);super(n);this.type=e,this.validator=r,this.value=s,Object.setPrototypeOf(this,Ke.prototype)}get all(){return[...this.validator.Errors(this.value)]}get model(){return Et.Value.Create(this.validator.schema)}toResponse(e){return new Response(this.message,{status:400,headers:e})}}var xr=new Headers,br=new RegExp(" (\\w+) = context","g"),Ye=(e)=>{const r=e.indexOf(")");if(e.charCodeAt(r+2)===61&&e.charCodeAt(r+5)!==123)return!0;return e.includes("return")},gr=(e)=>({composeValidation:(r,s=`c.${r}`)=>e?`c.set.status = 400; throw new ValidationError(
'${r}',
${r},
${s}
)`:`c.set.status = 400; return new ValidationError(
	'${r}',
	${r},
	${s}
).toResponse(c.set.headers)`,composeResponseValidation:(r="r")=>e?`throw new ValidationError(
'response',
response[c.set.status],
${r}
)`:`return new ValidationError(
'response',
response[c.set.status],
${r}
).toResponse(c.set.headers)`}),We=(e,r)=>{r=r.trimStart(),r=r.replaceAll(/^async /g,"");const s=r.charCodeAt(0)===40||r.startsWith("function")?r.slice(r.indexOf("(")+1,r.indexOf(")")):r.slice(0,r.indexOf("=")-1);if(s==="")return!1;if(s.charCodeAt(0)===123){if(s.includes(e))return!0;return!1}if(r.match(new RegExp(`${s}(.${e}|\\["${e}"\\])`)))return!0;const a=[s];for(let n of r.matchAll(br))a.push(n[1]);const T=new RegExp(`{.*?} = (${a.join("|")})`,"g");for(let[n]of r.matchAll(T))if(n.includes(`{ ${e}`)||n.includes(`, ${e}`))return!0;return!1},He=(e,r,s=[],a="")=>{if(r.type==="object"){const T=r.properties;for(let n in T){const E=T[n],o=!a?n:a+"."+n;if(E.type==="object"){He(e,E,s,o);continue}else if(E.anyOf){for(let C of E.anyOf)He(e,C,s,o);continue}if(E.elysiaMeta===e)s.push(o)}if(s.length===0)return null;return s}else if(r?.elysiaMeta===e){if(a)s.push(a);return"root"}return null},Vr=(e)=>{if(!e)return;const r=e?.schema;if(r&&("anyOf"in r)){let s=!1;const a=r.anyOf[0].type;for(let T of r.anyOf)if(T.type!==a){s=!0;break}if(!s)return a}},Rr=/(?:return|=>) \S*\(/g,Ie=(e)=>{if(e.constructor.name==="AsyncFunction")return!0;if(e.toString().match(Rr))return!0;return!1},Er=({method:e,hooks:r,validator:s,handler:a,handleError:T,meta:n,onRequest:E,config:o})=>{const C=o.forceErrorEncapsulation||r.error.length>0||typeof Bun==="undefined"||r.onResponse.length>0,{composeValidation:b,composeResponseValidation:P}=gr(C),G=r.onResponse.length?`\n;(async () => {${r.onResponse.map((j,I)=>`await res${I}(c)`).join(";")}})();\n`:"";let x=C?"try {\n":"";const F=s||e!=="GET"?[a,...r.transform,...r.beforeHandle,...r.afterHandle].map((j)=>j.toString()):[],N=e!=="GET"&&r.type!=="none"&&(!!s.body||!!r.type||F.some((j)=>We("body",j))),O=s.headers||F.some((j)=>We("headers",j));if(O)x+=xr.toJSON?"c.headers = c.request.headers.toJSON()\n":`c.headers = {}
                for (const [key, value] of c.request.headers.entries())
					c.headers[key] = value
				`;if(s.query||F.some((j)=>We("query",j)))x+=`const url = c.request.url

		if(c.qi !== -1) {
			c.query ??= parseQuery(url.substring(c.qi + 1))
		} else {
			c.query ??= {}
		}
		`;const U=F.some((j)=>We("set",j))||E.some((j)=>We("set",j.toString())),A=N||Ie(a)||r.parse.length>0||r.afterHandle.some(Ie)||r.beforeHandle.some(Ie)||r.transform.some(Ie);if(N){const j=Vr(s?.body);if(r.type||j){if(r.type)switch(r.type){case"application/json":x+="c.body = await c.request.json();";break;case"text/plain":x+="c.body = await c.request.text();";break;case"application/x-www-form-urlencoded":x+="c.body = parseQuery(await c.request.text());";break;case"application/octet-stream":x+="c.body = await c.request.arrayBuffer();";break;case"multipart/form-data":x+=`c.body = {}

					const form = await c.request.formData()
					for (const key of form.keys()) {
						if (c.body[key])
							continue

						const value = form.getAll(key)
						if (value.length === 1)
							c.body[key] = value[0]
						else c.body[key] = value
					}`;break}else if(j){const I=s?.body?.schema;switch(j){case"object":if(I.elysiaMeta==="URLEncoded")x+="c.body = parseQuery(await c.request.text())";else if(s.body.Code().includes("custom('File"))x+=`c.body = {}

							const form = await c.request.formData()
							for (const key of form.keys()) {
								if (c.body[key])
									continue
		
								const value = form.getAll(key)
								if (value.length === 1)
									c.body[key] = value[0]
								else c.body[key] = value
							}`;else x+="c.body = JSON.parse(await c.request.text())";break;default:x+="c.body = await c.request.text()";break}}if(r.parse.length)x+="}}"}else{if(x+="\n",x+=O?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",x+=`
            if (contentType) {
				const index = contentType.indexOf(';')
				if (index !== -1) contentType = contentType.substring(0, index)\n`,r.parse.length){x+="let used = false\n";for(let I=0;I<r.parse.length;I++){const W=`bo${I}`;if(I!==0)x+="if(!used) {\n";if(x+=`let ${W} = parse[${I}](c, contentType);`,x+=`if(${W} instanceof Promise) ${W} = await ${W};`,x+=`
						if(${W} !== undefined) { c.body = ${W}; used = true }\n`,I!==0)x+="}"}x+="if (!used)"}x+=`switch (contentType) {
			case 'application/json':
				c.body = await c.request.json()
				break

			case 'text/plain':
				c.body = await c.request.text()
				break

			case 'application/x-www-form-urlencoded':
				c.body = parseQuery(await c.request.text())
				break

			case 'application/octet-stream':
				c.body = await c.request.arrayBuffer();
				break

			case 'multipart/form-data':
				c.body = {}

				const form = await c.request.formData()
				for (const key of form.keys()) {
					if (c.body[key])
						continue

					const value = form.getAll(key)
					if (value.length === 1)
						c.body[key] = value[0]
					else c.body[key] = value
				}

				break
			}
		}\n`}x+="\n"}if(s.params){const j=He("Numeric",s.params.schema);if(j){switch(typeof j){case"object":for(let I of j)x+=`if(c.params.${I}) c.params.${I} = +c.params.${I};`;break}x+="\n"}}if(s.query){const j=He("Numeric",s.query.schema);if(j){switch(typeof j){case"object":for(let I of j)x+=`if(c.query.${I}) c.query.${I} = +c.query.${I};`;break}x+="\n"}}if(s.headers){const j=He("Numeric",s.headers.schema);if(j){switch(typeof j){case"object":for(let I of j)x+=`c.headers.${I} = +c.headers.${I};`;break}x+="\n"}}if(s.body){const j=He("Numeric",s.body.schema);if(j){switch(typeof j){case"string":x+="c.body = +c.body;";break;case"object":for(let I of j)x+=`c.body.${I} = +c.body.${I};`;break}x+="\n"}}if(r?.transform)for(let j=0;j<r.transform.length;j++)if(r.transform[j].$elysia==="derive")x+=Ie(r.transform[j])?`Object.assign(c, await transform[${j}](c));`:`Object.assign(c, transform[${j}](c));`;else x+=Ie(r.transform[j])?`await transform[${j}](c);`:`transform[${j}](c);`;if(s){if(s.headers)x+=`
                if (headers.Check(c.headers) === false) {
                    ${b("headers")}
				}
        `;if(s.params)x+=`if(params.Check(c.params) === false) { ${b("params")} }`;if(s.query)x+=`if(query.Check(c.query) === false) { ${b("query")} }`;if(s.body)x+=`if(body.Check(c.body) === false) { ${b("body")} }`}if(r?.beforeHandle)for(let j=0;j<r.beforeHandle.length;j++){const I=`be${j}`;if(!Ye(r.beforeHandle[j].toString()))x+=Ie(r.beforeHandle[j])?`await beforeHandle[${j}](c);\n`:`beforeHandle[${j}](c);\n`;else{if(x+=Ie(r.beforeHandle[j])?`let ${I} = await beforeHandle[${j}](c);\n`:`let ${I} = beforeHandle[${j}](c);\n`,x+=`if(${I} !== undefined) {\n`,r?.afterHandle){const W=I;for(let B=0;B<r.afterHandle.length;B++)if(!Ye(r.afterHandle[B].toString()))x+=Ie(r.afterHandle[B])?`await afterHandle[${B}](c, ${W});\n`:`afterHandle[${B}](c, ${W});\n`;else{const ue=`af${B}`;x+=Ie(r.afterHandle[B])?`const ${ue} = await afterHandle[${B}](c, ${W});\n`:`const ${ue} = afterHandle[${B}](c, ${W});\n`,x+=`if(${ue} !== undefined) { ${W} = ${ue} }\n`}}if(s.response)x+=`if(response[c.set.status]?.Check(${I}) === false) { 
						if(!(response instanceof Error))
							${P(I)}
					}\n`;x+=`return mapEarlyResponse(${I}, c.set)}\n`}}if(r?.afterHandle.length){x+=Ie(a)?"let r = await handler(c);\n":"let r = handler(c);\n";for(let j=0;j<r.afterHandle.length;j++){const I=`af${j}`;if(!Ye(r.afterHandle[j].toString()))x+=Ie(r.afterHandle[j])?`await afterHandle[${j}](c, r)\n`:`afterHandle[${j}](c, r)\n`;else if(x+=Ie(r.afterHandle[j])?`let ${I} = await afterHandle[${j}](c, r)\n`:`let ${I} = afterHandle[${j}](c, r)\n`,s.response)x+=`if(${I} !== undefined) {`,x+=`if(response[c.set.status]?.Check(${I}) === false) { 
						if(!(response instanceof Error))
						${P(I)}
					}\n`,x+=`${I} = mapEarlyResponse(${I}, c.set)\n`,x+=`if(${I}) return ${I};\n}`;else x+=`if(${I}) return ${I};\n`}if(s.response)x+=`if(response[c.set.status]?.Check(r) === false) { 
				if(!(response instanceof Error))
					${P()}
			}\n`;if(U)x+="return mapResponse(r, c.set)\n";else x+="return mapCompactResponse(r)\n"}else if(s.response)if(x+=Ie(a)?"const r = await handler(c);\n":"const r = handler(c);\n",x+=`if(response[c.set.status]?.Check(r) === false) { 
				if(!(response instanceof Error))
					${P()}
			}\n`,U)x+="return mapResponse(r, c.set)\n";else x+="return mapCompactResponse(r)\n";else{const j=Ie(a)?"await handler(c) ":"handler(c)";if(U)x+=`return mapResponse(${j}, c.set)\n`;else x+=`return mapCompactResponse(${j})\n`}if(C)x+=`
} catch(error) {
	

	${A?"":"return (async () => {"}
		const set = c.set

		if (!set.status || set.status < 300) set.status = 500

		${r.error.length?`for (let i = 0; i < handleErrors.length; i++) {
				let handled = handleErrors[i]({
					request: c.request,
					error: error,
					set,
					code: error.code ?? error[ERROR_CODE] ?? "UNKNOWN"
				})
				if (handled instanceof Promise) handled = await handled

				const response = mapEarlyResponse(handled, set)
				if (response) return response
			}`:""}

		return handleError(c.request, error, set)
	${A?"":"})()"}
} finally {
	${G}
}`;return x=`const { 
		handler,
		handleError,
		hooks: {
			transform,
			beforeHandle,
			afterHandle,
			parse,
			error: handleErrors,
			onResponse
		},
		validator: {
			body,
			headers,
			params,
			query,
			response
		},
		utils: {
			mapResponse,
			mapCompactResponse,
			mapEarlyResponse,
			parseQuery
		},
		error: {
			NotFoundError,
			ValidationError,
			InternalServerError
		},
		meta,
		ERROR_CODE
	} = hooks

	${r.onResponse.length?`const ${r.onResponse.map((j,I)=>`res${I} = onResponse[${I}]`).join(",")}`:""}

	return ${A?"async":""} function(c) {
		${n?'c["schema"] = meta["schema"]; c["defs"] = meta["defs"];':""}
		${x}
	}`,Function("hooks",x)({handler:a,hooks:r,validator:s,handleError:T,utils:{mapResponse:ze,mapCompactResponse:Dt,mapEarlyResponse:Fe,parseQuery:Tr.parse},error:{NotFoundError:ot,ValidationError:Ke,InternalServerError:At},meta:n,ERROR_CODE:$e})},Lt=(e)=>{let r="";for(let o of Object.keys(e.decorators))r+=`,${o}: app.decorators.${o}`;const{router:s,staticRouter:a}=e,T=`
	const route = find(request.method, path) ${s.root.ALL?'?? find("ALL", path)':""}
	if (route === null)
		return ${e.event.error.length?`handleError(
			request,
			notFound,
			ctx.set
		)`:`new Response(error404, {
					status: 404
				})`}

	ctx.params = route.params

	return route.store(ctx)`;let n="";for(let[o,{code:C,all:b}]of Object.entries(a.map))n+=`case '${o}':\nswitch(request.method) {\n${C}\n${b??`default: ${T}`}}\n\n`;let E=`const {
		app,
		app: { store, router, staticRouter },
		mapEarlyResponse,
		NotFoundError
	} = data

	const notFound = new NotFoundError()

	${e.event.request.length?"const onRequest = app.event.request":""}

	${a.variables}

	const find = router.find.bind(router)
	const handleError = app.handleError.bind(this)

	${e.event.error.length?"":"const error404 = notFound.message.toString()"}

	return function(request) {
	`;if(e.event.request.length){E+=`
			const ctx = {
				request,
				store,
				set: {
					headers: {},
					status: 200
				}
				${r}
			}

			try {\n`;for(let o=0;o<e.event.request.length;o++){const C=Ye(e.event.request[o].toString());E+=!C?`mapEarlyResponse(onRequest[${o}](ctx), ctx.set);`:`const response = mapEarlyResponse(
					onRequest[${o}](ctx),
					ctx.set
				)
				if (response) return response\n`}E+=`} catch (error) {
			return handleError(request, error, ctx.set)
		}
		
		const url = request.url,
		s = url.indexOf('/', 11),
		i = ctx.qi = url.indexOf('?', s + 1),
		path = ctx.path = i === -1 ? url.substring(s) : url.substring(s, i);`}else E+=`
		const url = request.url,
			s = url.indexOf('/', 11),
			qi = url.indexOf('?', s + 1),
			path = qi === -1
				? url.substring(s)
				: url.substring(s, qi)

		const ctx = {
			request,
			store,
			qi,
			path,
			set: {
				headers: {},
				status: 200
			}
			${r}
		}`;return E+=`
		switch(path) {
			${n}

			default:
				${T}
		}
	}`,e.handleError=Ft(e),Function("data",E)({app:e,mapEarlyResponse:Fe,NotFoundError:ot})},Ft=(e)=>{let r=`const {
		app: { event: { error: onError, onResponse: res } },
		mapResponse,
		ERROR_CODE
	} = inject

	return ${e.event.error.find(Ie)?"async":""} function(request, error, set) {`;for(let s=0;s<e.event.error.length;s++){const a=e.event.error[s],T=`${Ie(a)?"await ":""}onError[${s}]({
			request,
			code: error.code ?? error[ERROR_CODE] ?? 'UNKNOWN',
			error,
			set
		})`;if(Ye(a.toString()))r+=`const r${s} = ${T}; if(r${s} !== undefined) return mapResponse(r${s}, set)\n`;else r+=T+"\n"}return r+=`if(error.constructor.name === "ValidationError") {
		set.status = error.status ?? 400
		return new Response(
			error.message, 
			{ headers: set.headers, status: set.status }
		)
	} else {
		return new Response(error.message, { headers: set.headers, status: error.status ?? 500 })
	}
}`,Function("inject",r)({app:e,mapResponse:ze,ERROR_CODE:$e})},rt=(e)=>{const r=e.indexOf("/",10),s=e.indexOf("?",r);if(s===-1)return e.slice(r);return e.slice(r,s)};class Xe{raw;data;isSubscribed;constructor(e){this.raw=e,this.data=e.data,this.isSubscribed=e.isSubscribed}publish(e,r=void 0,s){if(typeof r==="object")r=JSON.stringify(r);return this.raw.publish(e,r,s),this}publishToSelf(e,r=void 0,s){if(typeof r==="object")r=JSON.stringify(r);return this.raw.publish(e,r,s),this}send(e){if(typeof e==="object")e=JSON.stringify(e);return this.raw.send(e),this}subscribe(e){return this.raw.subscribe(e),this}unsubscribe(e){return this.raw.unsubscribe(e),this}cork(e){return this.raw.cork(e),this}close(){return this.raw.close(),this}}var St=(e)=>(r)=>{if(!r.wsRouter)r.wsRouter=new Qe;const s=r.wsRouter;if(!r.config.serve)r.config.serve={websocket:{...e,open(a){if(!a.data)return;const T=rt(a?.data.request.url);if(!T)return;const n=s.find("subscribe",T)?.store;if(n&&n.open)n.open(new Xe(a))},message(a,T){if(!a.data)return;const n=rt(a?.data.request.url);if(!n)return;const E=s.find("subscribe",n)?.store;if(!E?.message)return;T=T.toString();const o=T.charCodeAt(0);if(o===47||o===123)try{T=JSON.parse(T)}catch(C){}else if(!Number.isNaN(+T))T=+T;for(let C=0;C<a.data.transformMessage.length;C++){const b=a.data.transformMessage[C](T);if(b!==void 0)T=b}if(a.data.message?.Check(T)===!1)return void a.send(new Ke("message",a.data.message,T).cause);E.message(new Xe(a),T)},close(a,T,n){if(!a.data)return;const E=rt(a?.data.request.url);if(!E)return;const o=s.find("subscribe",E)?.store;if(o&&o.close)o.close(new Xe(a),T,n)},drain(a){if(!a.data)return;const T=rt(a?.data.request.url);if(!T)return;const n=s.find("subscribe",T)?.store;if(n&&n.drain)n.drain(new Xe(a))}}};return r.decorate("publish",r.server?.publish).onStart((a)=>{a.decorators.publish=a.server?.publish})},yt=Be(Kt(),1),It=(e)=>async(r)=>{const s={status:200,headers:{}};let a;if(e.decorators)a=e.decorators,a.request=r,a.set=s,a.store=e.store;else a={set:s,store:e.store,request:r};const T=r.url,n=T.indexOf("/",11),E=T.indexOf("?",n+1),o=E===-1?T.substring(n):T.substring(n,E);try{for(let O=0;O<e.event.request.length;O++){const U=e.event.request[O];let A=U(a);if(A instanceof Promise)A=await A;if(A=Fe(A,s),A)return A}const C=e.dynamicRouter.find(r.method,o)??e.dynamicRouter.find("ALL",o);if(!C)throw new ot;const{handle:b,hooks:P,validator:G,content:x}=C.store;let F;if(r.method!=="GET")if(x)switch(x){case"application/json":F=await r.json();break;case"text/plain":F=await r.text();break;case"application/x-www-form-urlencoded":F=yt.parse(await r.text());break;case"application/octet-stream":F=await r.arrayBuffer();break;case"multipart/form-data":F={};const O=await r.formData();for(let U of O.keys()){if(F[U])continue;const A=O.getAll(U);if(A.length===1)F[U]=A[0];else F[U]=A}break}else{let O=r.headers.get("content-type");if(O){const U=O.indexOf(";");if(U!==-1)O=O.slice(0,U);for(let A=0;A<e.event.parse.length;A++){let j=e.event.parse[A](a,O);if(j instanceof Promise)j=await j;if(j){F=j;break}}if(F===void 0)switch(O){case"application/json":F=await r.json();break;case"text/plain":F=await r.text();break;case"application/x-www-form-urlencoded":F=yt.parse(await r.text());break;case"application/octet-stream":F=await r.arrayBuffer();break;case"multipart/form-data":F={};const A=await r.formData();for(let j of A.keys()){if(F[j])continue;const I=A.getAll(j);if(I.length===1)F[j]=I[0];else F[j]=I}break}}}a.body=F,a.params=C?.params||{},a.query=E===-1?{}:yt.parse(T.substring(E+1));for(let O=0;O<P.transform.length;O++){const U=P.transform[O](a);if(P.transform[O].$elysia==="derive")if(U instanceof Promise)Object.assign(a,await U);else Object.assign(a,U);else if(U instanceof Promise)await U}if(G){if(G.headers){const O={};for(let U in r.headers)O[U]=r.headers.get(U);if(G.headers.Check(O)===!1)throw new Ke("header",G.headers,O)}if(G.params?.Check(a.params)===!1)throw new Ke("params",G.params,a.params);if(G.query?.Check(a.query)===!1)throw new Ke("query",G.query,a.query);if(G.body?.Check(F)===!1)throw new Ke("body",G.body,F)}for(let O=0;O<P.beforeHandle.length;O++){let U=P.beforeHandle[O](a);if(U instanceof Promise)U=await U;if(U!==void 0){for(let j=0;j<P.afterHandle.length;j++){let I=P.afterHandle[j](a,U);if(I instanceof Promise)I=await I;if(I)U=I}const A=Fe(U,a.set);if(A)return A}}let N=b(a);if(N instanceof Promise)N=await N;if(!P.afterHandle.length){const O=G?.response?.[N.status];if(O?.Check(N)===!1)throw new Ke("response",O,N)}else for(let O=0;O<P.afterHandle.length;O++){let U=P.afterHandle[O](a,N);if(U instanceof Promise)U=await U;const A=Fe(U,a.set);if(A!==void 0){const j=G?.response?.[N.status];if(j?.Check(A)===!1)throw new Ke("response",j,A);return A}}return ze(N,a.set)}catch(C){if(C.status)s.status=C.status;return e.handleError(r,C,s)}finally{for(let C of e.event.onResponse)await C(a)}},Cr=(e)=>async(r,s,a={headers:{}})=>{for(let T=0;T<e.event.error.length;T++){let n=e.event.error[T]({request:r,code:s.code??s[$e]??"UNKNOWN",error:s,set:a});if(n instanceof Promise)n=await n;if(n!==void 0&&n!==null)return ze(n,a)}return new Response(typeof s.cause==="string"?s.cause:s.message,{headers:a.headers,status:s.status??500})},Me=Be(Pe(),1),Ae=Be(it(),1);try{Ae.TypeSystem.Format("email",(e)=>/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i.test(e)),Ae.TypeSystem.Format("uuid",(e)=>/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)),Ae.TypeSystem.Format("date",(e)=>!Number.isNaN(new Date(e).getTime())),Ae.TypeSystem.Format("date-time",(e)=>!Number.isNaN(new Date(e).getTime()))}catch(e){}var kt=(e)=>{if(typeof e==="string")switch(e.slice(-1)){case"k":return+e.slice(0,e.length-1)*1024;case"m":return+e.slice(0,e.length-1)*1048576;default:return+e}return e},jt=(e,r)=>{if(!(r instanceof Blob))return!1;if(e.minSize&&r.size<kt(e.minSize))return!1;if(e.maxSize&&r.size>kt(e.maxSize))return!1;if(e.extension)if(typeof e.extension==="string"){if(!r.type.startsWith(e.extension))return!1}else{for(let s=0;s<e.extension.length;s++)if(r.type.startsWith(e.extension[s]))return!0;return!1}return!0},Mt={Numeric:Ae.TypeSystem.Type("Numeric",{}),File:Ae.TypeSystem.Type("File",jt),Files:Ae.TypeSystem.Type("Files",(e,r)=>{if(!Array.isArray(r))return!1;if(e.minItems&&r.length<e.minItems)return!1;if(e.maxItems&&r.length>e.maxItems)return!1;for(let s=0;s<r.length;s++)if(!jt(e,r[s]))return!1;return!0})};Me.Type.Numeric=(e)=>{return Me.Type.Number({...e,elysiaMeta:"Numeric"})};Me.Type.URLEncoded=(e,r)=>{return Me.Type.Object(e,{...r,elysiaMeta:"URLEncoded"})};Me.Type.File=(e)=>Mt.File({elysiaMeta:"File",default:"File",...e,extension:e?.type,type:"string",format:"binary"});Me.Type.Files=(e)=>Mt.Files({...e,elysiaMeta:"Files",default:"Files",extension:e?.type,type:"array",items:{...e,default:"Files",type:"string",format:"binary"}});class et{config;dependencies={};store={};meta={schema:Object.create(null),defs:Object.create(null),exposed:Object.create(null)};decorators={};event={start:[],request:[],parse:[],transform:[],beforeHandle:[],afterHandle:[],onResponse:[],error:[],stop:[]};server=null;$schema=null;error={};router=new Qe;routes=[];staticRouter={handlers:[],variables:"",map:{},all:""};wsRouter;dynamicRouter=new Qe;lazyLoadModules=[];path="";constructor(e){this.config={forceErrorEncapsulation:!1,prefix:"",aot:!0,strictPath:!1,scoped:!1,...e,seed:e?.seed===void 0?"":e?.seed}}add(e,r,s,a,{allowMeta:T=!1,skipPrefix:n=!1}={allowMeta:!1,skipPrefix:!1}){if(r=r===""?r:r.charCodeAt(0)===47?r:`/${r}`,this.config.prefix&&!n)r=this.config.prefix+r;const E=this.meta.defs;if(a?.type)switch(a.type){case"text":a.type="text/plain";break;case"json":a.type="application/json";break;case"formdata":a.type="multipart/form-data";break;case"urlencoded":a.type="application/x-www-form-urlencoded";break;case"arrayBuffer":a.type="application/octet-stream";break;default:break}const o={body:_e(a?.body??this.$schema?.body,{dynamic:!this.config.aot,models:E}),headers:_e(a?.headers??this.$schema?.headers,{dynamic:!this.config.aot,models:E,additionalProperties:!0}),params:_e(a?.params??this.$schema?.params,{dynamic:!this.config.aot,models:E}),query:_e(a?.query??this.$schema?.query,{dynamic:!this.config.aot,models:E}),response:hr(a?.response??this.$schema?.response,{dynamic:!this.config.aot,models:E})},C=Ze(this.event,a),b=r.endsWith("/")?r.slice(0,r.length-1):r+"/";if(this.config.aot===!1){if(this.dynamicRouter.add(e,r,{validator:o,hooks:C,content:a?.type,handle:s}),this.config.strictPath===!1)this.dynamicRouter.add(e,b,{validator:o,hooks:C,content:a?.type,handle:s});this.routes.push({method:e,path:r,composed:null,handler:s,hooks:C});return}const P=Er({path:r,method:e,hooks:C,validator:o,handler:s,handleError:this.handleError,meta:T?this.meta:void 0,onRequest:this.event.request,config:this.config});if(this.routes.push({method:e,path:r,composed:P,handler:s,hooks:C}),r.indexOf(":")===-1&&r.indexOf("*")===-1){const G=this.staticRouter.handlers.length;if(this.staticRouter.handlers.push(P),this.staticRouter.variables+=`const st${G} = staticRouter.handlers[${G}]\n`,!this.staticRouter.map[r])this.staticRouter.map[r]={code:""};if(e==="ALL")this.staticRouter.map[r].all=`default: return st${G}(ctx)\n`;else this.staticRouter.map[r].code+=`case '${e}': return st${G}(ctx)\n`;if(!this.config.strictPath){if(!this.staticRouter.map[b])this.staticRouter.map[b]={code:""};if(e==="ALL")this.staticRouter.map[b].all=`default: return st${G}(ctx)\n`;else this.staticRouter.map[b].code+=`case '${e}': return st${G}(ctx)\n`}}else if(this.router.add(e,r,P),!this.config.strictPath)this.router.add(e,r.endsWith("/")?r.slice(0,r.length-1):r+"/",P)}onStart(e){return this.on("start",e),this}onRequest(e){return this.on("request",e),this}onParse(e){return this.on("parse",e),this}onTransform(e){return this.on("transform",e),this}onBeforeHandle(e){return this.on("beforeHandle",e),this}onAfterHandle(e){return this.on("afterHandle",e),this}onResponse(e){return this.on("response",e),this}addError(e,r){if(typeof e==="string"&&r)return r.prototype[$e]=e,this;for(let[s,a]of Object.entries(e))a.prototype[$e]=s;return this}onError(e){return this.on("error",e),this}onStop(e){return this.on("stop",e),this}on(e,r){switch(r=vr(r),e){case"start":this.event.start.push(r);break;case"request":this.event.request.push(r);break;case"response":this.event.onResponse.push(r);break;case"parse":this.event.parse.splice(this.event.parse.length-1,0,r);break;case"transform":this.event.transform.push(r);break;case"beforeHandle":this.event.beforeHandle.push(r);break;case"afterHandle":this.event.afterHandle.push(r);break;case"error":this.event.error.push(r);break;case"stop":this.event.stop.push(r);break}return this}group(e,r,s){const a=new et({...this.config,prefix:""});if(a.store=this.store,this.wsRouter)a.use(St());const T=typeof r==="object",n=(T?s:r)(a);if(this.decorators=De(this.decorators,a.decorators),n.event.request.length)this.event.request=[...this.event.request,...n.event.request];if(n.event.onResponse.length)this.event.onResponse=[...this.event.onResponse,...n.event.onResponse];if(this.model(n.meta.defs),Object.values(a.routes).forEach(({method:E,path:o,handler:C,hooks:b})=>{if(o=this.config.prefix+e+o,T){const P=r,G=b;if(a.wsRouter?.find("subscribe",o)){const x=a.wsRouter.history.find(([F,N])=>o===N);if(!x)return;return this.ws(o,x[2])}this.add(E,o,C,Ze(P,{...G,error:!G.error?n.event.error:Array.isArray(G.error)?[...G.error,...n.event.error]:[G.error,...n.event.error]}))}else{if(a.wsRouter?.find("subscribe",o)){const P=a.wsRouter.history.find(([G,x])=>o===x);if(!P)return;return this.ws(o,P[2])}this.add(E,o,C,Ze(b,{error:n.event.error}),{skipPrefix:!0})}}),a.wsRouter&&this.wsRouter)a.wsRouter.history.forEach(([E,o,C])=>{if(o=this.config.prefix+e+o,o==="/")this.wsRouter?.add(E,e,C);else this.wsRouter?.add(E,`${e}${o}`,C)});return this}guard(e,r){if(!r)return this.event=ht(this.event,e),this.$schema={body:e.body,headers:e.headers,params:e.params,query:e.query,response:e.response},this;const s=new et;if(s.store=this.store,this.wsRouter)s.use(St());const a=r(s);if(this.decorators=De(this.decorators,s.decorators),a.event.request.length)this.event.request=[...this.event.request,...a.event.request];if(a.event.onResponse.length)this.event.onResponse=[...this.event.onResponse,...a.event.onResponse];if(this.model(a.meta.defs),Object.values(s.routes).forEach(({method:T,path:n,handler:E,hooks:o})=>{if(s.wsRouter?.find("subscribe",n)){const C=s.wsRouter.history.find(([b,P])=>n===P);if(!C)return;return this.ws(n,C[2])}this.add(T,n,E,Ze(e,{...o,error:!o.error?a.event.error:Array.isArray(o.error)?[...o.error,...a.event.error]:[o.error,...a.event.error]}))}),s.wsRouter&&this.wsRouter)s.wsRouter.history.forEach(([T,n,E])=>{this.wsRouter?.add(T,n,E)});return this}use(e){const r=(s)=>{if(typeof s==="function"){const E=s(this);if(E instanceof Promise)return this.lazyLoadModules.push(E.then((o)=>o.compile())),this;return E}const a=s.config.scoped;if(!a)this.decorators=De(this.decorators,s.decorators),this.model(s.meta.defs);const{config:{name:T,seed:n}}=s;if(Object.values(s.routes).forEach(({method:E,path:o,handler:C,hooks:b})=>{if(s.wsRouter?.find("subscribe",o)){const P=s.wsRouter.history.find(([G,x])=>o===x);if(!P)return;return this.ws(o,P[2])}this.add(E,o,C,Ze(b,{error:s.event.error}))}),!a)if(T){if(!(T in this.dependencies))this.dependencies[T]=[];const E=n!==void 0?yr(T+JSON.stringify(n)):0;if(this.dependencies[T].some((o)=>E===o))return this;this.dependencies[T].push(E),this.event=ht(this.event,Rt(s.event),E)}else this.event=ht(this.event,Rt(s.event));return this};if(e instanceof Promise)return this.lazyLoadModules.push(e.then((s)=>{if(typeof s==="function")return s(this);if(typeof s.default==="function")return s.default(this);return r(s.default)}).then((s)=>s.compile())),this;else return r(e);return this}mount(e,r){if(typeof e==="function"||e.length===0||e==="/"){const T=typeof e==="function"?e:r,n=async({request:E,path:o})=>T(new Request("http://a.cc"+o||"/",E));return this.all("/",n,{type:"none"}),this.all("/*",n,{type:"none"}),this}const s=e.length,a=async({request:T,path:n})=>r(new Request("http://a.cc"+n.slice(s)||"/",T));return this.all(e,a,{type:"none"}),this.all(e+(e.endsWith("/")?"*":"/*"),a,{type:"none"}),this}get(e,r,s){return this.add("GET",e,r,s),this}post(e,r,s){return this.add("POST",e,r,s),this}put(e,r,s){return this.add("PUT",e,r,s),this}patch(e,r,s){return this.add("PATCH",e,r,s),this}delete(e,r,s){return this.add("DELETE",e,r,s),this}options(e,r,s){return this.add("OPTIONS",e,r,s),this}all(e,r,s){return this.add("ALL",e,r,s),this}head(e,r,s){return this.add("HEAD",e,r,s),this}trace(e,r,s){return this.add("TRACE",e,r,s),this}connect(e,r,s){return this.add("CONNECT",e,r,s),this}ws(e,r){if(!this.wsRouter)throw new Error("Can't find WebSocket. Please register WebSocket plugin first by importing 'elysia/ws'");return this.wsRouter.add("subscribe",e,r),this.get(e,(s)=>{if(this.server?.upgrade(s.request,{headers:typeof r.upgrade==="function"?r.upgrade(s):r.upgrade,data:{...s,id:Date.now(),headers:s.request.headers.toJSON(),message:_e(r?.body,{models:this.meta.defs}),transformMessage:!r.transform?[]:Array.isArray(r.transformMessage)?r.transformMessage:[r.transformMessage]}}))return;return s.set.status=400,"Expected a websocket connection"},{beforeHandle:r.beforeHandle,transform:r.transform,headers:r?.headers,params:r?.params,query:r?.query}),this}route(e,r,s,{config:a,...T}={config:{allowMeta:!1}}){return this.add(e,r,s,T,a),this}state(e,r){if(typeof e==="object")return this.store=De(this.store,e),this;if(!(e in this.store))this.store[e]=r;return this}decorate(e,r){if(typeof e==="object")return this.decorators=De(this.decorators,e),this;if(!(e in this.decorators))this.decorators[e]=r;return this}derive(e){return e.$elysia="derive",this.onTransform(e)}schema(e){const r=this.meta.defs;return this.$schema={body:_e(e.body,{models:r}),headers:_e(e?.headers,{models:r,additionalProperties:!0}),params:_e(e?.params,{models:r}),query:_e(e?.query,{models:r}),response:_e(e?.response,{models:r})},this}compile(){if(this.fetch=this.config.aot?Lt(this):It(this),typeof this.server?.reload==="function")this.server.reload({...this.server,fetch:this.fetch});return this}handle=async(e)=>this.fetch(e);fetch=(e)=>(this.fetch=this.config.aot?Lt(this):It(this))(e);handleError=async(e,r,s)=>(this.handleError=this.config.aot?Ft(this):Cr(this))(e,r,s);outerErrorHandler=(e)=>new Response(e.message,{status:e?.status??500});listen=(e,r)=>{if(!Bun)throw new Error("Bun to run");if(this.compile(),typeof e==="string"){if(e=+e.trim(),Number.isNaN(e))throw new Error("Port must be a numeric value")}const s=this.fetch,a=typeof e==="object"?{development:!at,...this.config.serve,...e,fetch:s,error:this.outerErrorHandler}:{development:!at,...this.config.serve,port:e,fetch:s,error:this.outerErrorHandler};if(typeof Bun==="undefined")throw new Error(".listen() is designed to run on Bun only. If you are running Elysia in other environment please use a dedicated plugin or export the handler via Elysia.fetch");this.server=Bun?.serve(a);for(let T=0;T<this.event.start.length;T++)this.event.start[T](this);if(r)r(this.server);return Promise.all(this.lazyLoadModules).then(()=>{Bun?.gc(!0)}),this};stop=async()=>{if(!this.server)throw new Error("Elysia isn't running. Call `app.listen` to start the server.");this.server.stop();for(let e=0;e<this.event.stop.length;e++)await this.event.stop[e](this)};get modules(){return Promise.all(this.lazyLoadModules)}model(e,r){if(typeof e==="object")Object.entries(e).forEach(([s,a])=>{if(!(s in this.meta.defs))this.meta.defs[s]=a});else this.meta.defs[e]=r;return this}}var Sr=Me.Type;class Lr{config;server;constructor(e){this.config=e,this.server=new et,this.server.listen(this.config.port)}}export{Lr as WibeApp};
